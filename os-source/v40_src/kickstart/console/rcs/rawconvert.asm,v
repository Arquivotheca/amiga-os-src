head     36.6;
branch   ;
access   ;
symbols  V39_4:36.6 V37_157:36.6 V37_149:36.6 V37_136:36.6 V37_133:36.6 V37_110:36.6 V37_98:36.6 V37_85:36.6 V37_63:36.6 V37_36:36.6 V37_15:36.5 V37_10:36.5 V37_7:36.5 V37_2:36.5 V36_558:36.5 V36_554:36.5 V36_552:36.5 V36_549:36.5 V36_548:36.5 V36_547:36.5 V36_546:36.5 V36_545:36.5 V36_544:36.5 V36_543:36.5 V36_542:36.5 V36_540:36.5 V36_539:36.5 V36_538:36.5 V36_537:36.5 V36_536:36.5 V36_529:36.5 V36_527:36.5 V36_525:36.5 V36_524:36.5 V36_523:36.5 V36_522:36.5 V36_521:36.5 V36_520:36.5 V36_519:36.5 V36_518:36.5 V36_495:36.5 V36_491:36.5 V36_486:36.5 V36_482:36.5 V36_476:36.5 V36_471:36.5 V36_465:36.5 V36_463:36.5 V36_461:36.5 V36_460:36.5 V36_453:36.5 V36_447:36.5 V36_442:36.5 V36_429:36.5 V36_423:36.5 V36_413:36.5 V36_394:36.4 V36_387:36.4 V36_382:36.4 V36_381:36.4 V36_379:36.3 V36_373:36.3 V36_367:36.3 V36_361:36.3 V36_359:36.3 V36_357:36.3 V36_353:36.3 V36_346:36.3 V36_343:36.3 V36_338:36.3 V36_332:36.3 V36_327:36.3 V36_321:36.3 V36_319:36.3 V36_318:36.2 V36_316:36.2 V36_313:36.2 V36_311:36.2 V36_310:36.2 V36_300:36.2 V36_299:36.2 V36_297:36.2 V36_295:36.2 V36_278:36.2 V36_274:36.2 V36_221:36.1 V36_205:36.1 V36_171:36.0 V36_167:36.0 V36_165:36.0 V36_153:36.0 V36_146:36.0 V36_140:36.0 V36_129:36.0 V36_113:36.0 V36_56:36.0 V36_53:36.0 V36_51:36.0 V36_45:36.0 L36_42:36.0;
locks    ; strict;
comment  @*   @;


36.6
date     91.02.14.14.55.43;  author darren;  state Exp;
branches ;
next     36.5;

36.5
date     90.04.13.13.32.42;  author kodiak;  state Exp;
branches ;
next     36.4;

36.4
date     90.04.02.10.47.27;  author kodiak;  state Exp;
branches ;
next     36.3;

36.3
date     89.12.19.13.27.46;  author kodiak;  state Exp;
branches ;
next     36.2;

36.2
date     89.12.02.11.37.03;  author kodiak;  state Exp;
branches ;
next     36.1;

36.1
date     89.11.03.12.24.43;  author kodiak;  state Exp;
branches ;
next     36.0;

36.0
date     88.09.06.19.52.09;  author kodiak;  state Exp;
branches ;
next     ;


desc
@@


36.6
log
@Autodoc stuff
@
text
@**
**	$Id: rawconvert.asm,v 36.5 90/04/13 13:32:42 kodiak Exp Locker: darren $
**
**      raw input event to ANSI translation
**
**      (C) Copyright 1985,1989 Commodore-Amiga, Inc.
**          All Rights Reserved
**
	SECTION	console

**	Includes

	INCLUDE	"cddata.i"


**	Exports

	XDEF	RawKeyConvert


**	Imports

	XLVO	MapRawKey		; Keymap


******* console.device/RawKeyConvert *********************************
*
*    NAME
*	RawKeyConvert -- decode raw input classes
*
*    SYNOPSIS
*	actual = RawKeyConvert(event, buffer, length, keyMap)
*	D0       	       A0     A1      D1      A2
*
*	ConsoleDevice in A6 if called from Assembly Language.
*
*    FUNCTION
*	This console function converts input events of type
*	IECLASS_RAWKEY to ANSI bytes, based on the keyMap, and
*	places the result into the buffer.
*
*    INPUTS
*	event -  an InputEvent structure pointer.
*	buffer - a byte buffer large enough to hold all anticipated
*	    characters generated by this conversion.
*	length - maximum anticipation, i.e. the buffer size in bytes.
*	keyMap - a KeyMap structure pointer, or null if the default
*	    console device key map is to be used.
*
*    RESULTS
*	actual - the number of characters in the buffer, or -1 if
*	    a buffer overflow was about to occur.
*
*    ERRORS
*	if actual is -1, a buffer overflow condition was detected.
*	Not all of the characters in the buffer are valid.
*
*    NOTES
*	This function is different from standard device commands in
*	that it is a function in the console device library vectors.
*	In order to obtain a valid library base pointer for the
*	console device (a.k.a. ConsoleDevice) call
*	OpenDevice("console.device", -1, IOStdReq, 0),
*	and then grab the io_Device pointer field out of the IOStdReq
*	and use as ConsoleDevice.
*
*    BUGS
*
*    SEE ALSO
*	exec/io.h, devices/inputevent.h, devices/keymap.h
*
********************************************************************************

RawKeyConvert:
		MOVEM.L D2-D3/A3,-(A7)
		move.l	a0,a3		; save event list head
		MOVE.L	D1,D2		; save maximum buffered
		MOVEQ	#0,D3		; show nothing buffered

convertLoop:
		LINKKEY	MapRawKey
		TST.L	D0
		BMI.S	rcRts		; buffer overflow: stop now
		SUB.L	D0,D2		; fewer buffer slots remaining
		ADD.L	D0,D3		; update actual

chkNext:
		MOVE.L	(A3),D0
		MOVE.L	D0,A0
		BNE	convertLoop

		MOVE.W	D3,D0		; return actual
rcRts:
		MOVEM.L (A7)+,D2-D3/A3
		RTS

		END
@


36.5
log
@use Id instead of Header for 4.x rcs
@
text
@d2 1
a2 1
**	$Id$
d29 1
a29 1
*	RawKeyConvert - decode raw input classes
@


36.4
log
@for 4.x rcs
@
text
@d2 1
a2 1
**	$Header: /usr2/kodiak/src/KS/console/RCS/rawconvert.asm,v 36.3 89/12/19 13:27:46 kodiak Exp Locker: kodiak $
@


36.3
log
@autodoc update
@
text
@d2 1
a2 1
**	$Header: rawconvert.asm,v 36.2 89/12/02 11:37:03 kodiak Exp $
@


36.2
log
@
@
text
@d2 1
a2 1
**	$Header$
d26 1
a26 1
******* console.device/function/RawKeyConvert **********************************
d70 1
a70 2
*	console.device/function/OpenDevice, exec/io.h,
*	    devices/inputevent.h, devices/keymap.h
@


36.1
log
@coalesce XREF_XXX into XLVO
@
text
@d1 9
a9 31
	TTL    '$Header: rawconvert.asm,v 36.0 88/09/06 19:52:09 kodiak Exp $'
**********************************************************************
*								     *
*   Copyright 1985, Commodore-Amiga Inc.   All rights reserved.	     *
*   No part of this program may be reproduced, transmitted,	     *
*   transcribed, stored in retrieval system, or translated into	     *
*   any language or computer language, in any form or by any	     *
*   means, electronic, mechanical, magnetic, optical, chemical,	     *
*   manual or otherwise, without the prior written permission of     *
*   Commodore-Amiga Incorporated, 983 University Ave. Building #D,   *
*   Los Gatos, California, 95030				     *
*								     *
**********************************************************************
*
*	Raw Input Event to Ansi translation
*
*   Source Control
*   --------------
*   $Header: rawconvert.asm,v 36.0 88/09/06 19:52:09 kodiak Exp $
*
*   $Locker: kodiak $
*
*   $Log:	rawconvert.asm,v $
*   Revision 36.0  88/09/06  19:52:09  kodiak
*   *** empty log message ***
*   
*   Revision 35.0  87/10/26  11:13:37  kodiak
*   initial from V34, but w/ stripped log
*   
*
**********************************************************************
d11 1
a11 1
	SECTION		rawinput
d13 1
a13 1
*------ Included Files -----------------------------------------------
a14 1
	INCLUDE		"cddata.i"
d16 1
a16 1
	XLVO	MapRawKey		; Keymap
d18 1
a18 1
*------ Exported Names -----------------------------------------------
d20 4
a23 1
	XDEF		RawKeyConvert
@


36.0
log
@*** empty log message ***
@
text
@d1 1
a1 1
	TTL    '$Header: rawconvert.asm,v 35.0 87/10/26 11:13:37 kodiak Exp $'
d19 1
a19 1
*   $Header: rawconvert.asm,v 35.0 87/10/26 11:13:37 kodiak Exp $
d21 1
a21 1
*   $Locker:  $
d24 3
d39 1
a39 1
	XREF_KEY	MapRawKey
@
