head     38.14;
branch   ;
access   ;
symbols  ;
locks    ; strict;
comment  @ * @;


38.14
date     92.03.24.18.00.37;  author vertex;  state Exp;
branches ;
next     38.13;

38.13
date     92.02.03.14.13.36;  author vertex;  state Exp;
branches ;
next     38.12;

38.12
date     91.11.24.19.14.14;  author vertex;  state Exp;
branches ;
next     38.11;

38.11
date     91.11.12.16.29.36;  author vertex;  state Exp;
branches ;
next     38.10;

38.10
date     91.11.11.13.00.57;  author vertex;  state Exp;
branches ;
next     38.9;

38.9
date     91.11.11.11.55.10;  author vertex;  state Exp;
branches ;
next     38.8;

38.8
date     91.09.19.17.15.39;  author vertex;  state Exp;
branches ;
next     38.7;

38.7
date     91.09.19.17.06.22;  author vertex;  state Exp;
branches ;
next     38.6;

38.6
date     91.08.20.11.08.50;  author vertex;  state Exp;
branches ;
next     38.5;

38.5
date     91.08.12.13.13.31;  author vertex;  state Exp;
branches ;
next     38.4;

38.4
date     91.08.06.16.50.31;  author vertex;  state Exp;
branches ;
next     38.3;

38.3
date     91.07.15.11.48.31;  author vertex;  state Exp;
branches ;
next     38.2;

38.2
date     91.07.10.17.48.50;  author vertex;  state Exp;
branches ;
next     38.1;

38.1
date     91.07.08.14.31.33;  author vertex;  state Exp;
branches ;
next     ;


desc
@Prefs editor shell - PrinterGfx custom interface
@


38.14
log
@Removed WA_Left and WA_Top
@
text
@
/* includes */
#include <exec/types.h>
#include <exec/libraries.h>
#include <exec/ports.h>
#include <exec/memory.h>
#include <exec/execbase.h>
#include <devices/keymap.h>
#include <intuition/intuition.h>
#include <intuition/screens.h>
#include <intuition/gadgetclass.h>
#include <graphics/text.h>
#include <libraries/asl.h>
#include <libraries/gadtools.h>
#include <libraries/locale.h>
#include <prefs/printergfx.h>
#include <dos/dos.h>
#include <string.h>

/* prototypes */
#include <clib/exec_protos.h>
#include <clib/dos_protos.h>
#include <clib/iffparse_protos.h>
#include <clib/gadtools_protos.h>
#include <clib/intuition_protos.h>
#include <clib/graphics_protos.h>
#include <clib/alib_protos.h>
#include <clib/utility_protos.h>
#include <clib/asl_protos.h>
#include <clib/locale_protos.h>

/* direct ROM interface */
#include <pragmas/exec_pragmas.h>
#include <pragmas/dos_pragmas.h>
#include <pragmas/iffparse_pragmas.h>
#include <pragmas/gadtools_pragmas.h>
#include <pragmas/intuition_pragmas.h>
#include <pragmas/graphics_pragmas.h>
#include <pragmas/utility_pragmas.h>
#include <pragmas/asl_pragmas.h>
#include <pragmas/locale_pragmas.h>

/* application includes */
#include "pe_custom.h"
#include "pe_strings.h"
#include "pe_utils.h"
#include "pe_iff.h"


#define SysBase ed->ed_SysBase


/*****************************************************************************/


ULONG GetColors(EdDataPtr ed);
ULONG GetMM(EdDataPtr ed, ULONG tenths);
ULONG GetTenths(EdDataPtr ed, ULONG mm);


/*****************************************************************************/


/* The IFF chunks known to this prefs editor. IFFPrefChunkCnt says how many
 * chunks there are
 */
#define IFFPrefChunkCnt 2
static LONG far IFFPrefChunks[] =
{
    ID_PREF, ID_PRHD,
    ID_PREF, ID_PGFX,
};


/*****************************************************************************/


/* The PrefHeader structure this editor outputs */
static struct PrefHeader far IFFPrefHeader =
{
    0,   /* version */
    0,   /* type    */
    0    /* flags   */
};


/*****************************************************************************/


#define NEW_PS_COLOR       PS_GREY_SCALE2
#define NEW_PS_GREY_SCALE2 PS_COLOR


/*****************************************************************************/


EdStatus InitEdData(EdDataPtr ed)
{
struct Locale *locale;

    ed->ed_PrefsDefaults.pg_Aspect         = PA_HORIZONTAL;
    ed->ed_PrefsDefaults.pg_Shade          = PS_BW;
    ed->ed_PrefsDefaults.pg_Image          = PI_POSITIVE;
    ed->ed_PrefsDefaults.pg_Threshold      = 7;
    ed->ed_PrefsDefaults.pg_ColorCorrect   = 0;
    ed->ed_PrefsDefaults.pg_Dimensions     = PD_IGNORE;
    ed->ed_PrefsDefaults.pg_Dithering      = PD_ORDERED;
    ed->ed_PrefsDefaults.pg_GraphicFlags   = 0;
    ed->ed_PrefsDefaults.pg_PrintDensity   = 1;
    ed->ed_PrefsDefaults.pg_PrintMaxWidth  = 0;
    ed->ed_PrefsDefaults.pg_PrintMaxHeight = 0;
    ed->ed_PrefsDefaults.pg_PrintXOffset   = 0;
    ed->ed_PrefsDefaults.pg_PrintYOffset   = 0;

    ed->ed_PrefsWork    = ed->ed_PrefsDefaults;
    ed->ed_PrefsInitial = ed->ed_PrefsDefaults;

    ed->ed_Metric       = FALSE;

    if (LocaleBase)
    {
        if (locale = OpenLocale(NULL))
        {
            ed->ed_Metric = (locale->loc_MeasuringSystem == MS_ISO);
            CloseLocale(locale);
        }
    }

    return(ES_NORMAL);
}


/*****************************************************************************/


EdStatus ReadPrefs(EdDataPtr ed, struct IFFHandle *iff, struct ContextNode *cn)
{
    if (cn->cn_ID != ID_PGFX || cn->cn_Type != ID_PREF)
        return(ES_IFF_UNKNOWNCHUNK);

    if (ReadChunkBytes(iff,&ed->ed_PrefsWork,sizeof(struct PrinterGfxPrefs)) == sizeof(struct PrinterGfxPrefs))
    {
        if (ed->ed_PrefsWork.pg_Shade == PS_COLOR)
        {
            ed->ed_PrefsWork.pg_Shade = NEW_PS_COLOR;
        }
        else if (ed->ed_PrefsWork.pg_Shade == PS_GREY_SCALE2)
        {
             ed->ed_PrefsWork.pg_Shade = NEW_PS_GREY_SCALE2;
        }
        return(ES_NORMAL);
    }

    return(ES_IFFERROR);
}


EdStatus OpenPrefs(EdDataPtr ed, STRPTR name)
{
    return(ReadIFF(ed,name,IFFPrefChunks,IFFPrefChunkCnt,ReadPrefs));
}


/*****************************************************************************/


EdStatus WritePrefs(EdDataPtr ed, struct IFFHandle *iff, struct ContextNode *cn)
{
EdStatus result;

    if (ed->ed_PrefsWork.pg_Shade == NEW_PS_COLOR)
    {
        ed->ed_PrefsWork.pg_Shade = PS_COLOR;
    }
    else if (ed->ed_PrefsWork.pg_Shade == NEW_PS_GREY_SCALE2)
    {
        ed->ed_PrefsWork.pg_Shade = PS_GREY_SCALE2;
    }

    result = ES_IFFERROR;
    if (!PushChunk(iff,0,ID_PGFX,sizeof(struct PrinterGfxPrefs)))
        if (WriteChunkBytes(iff,&ed->ed_PrefsWork,sizeof(struct PrinterGfxPrefs)) == sizeof(struct PrinterGfxPrefs))
            if (!PopChunk(iff))
                result = ES_NORMAL;

    if (ed->ed_PrefsWork.pg_Shade == PS_COLOR)
    {
         ed->ed_PrefsWork.pg_Shade = NEW_PS_COLOR;
    }
    else if (ed->ed_PrefsWork.pg_Shade == PS_GREY_SCALE2)
    {
         ed->ed_PrefsWork.pg_Shade = NEW_PS_GREY_SCALE2;
    }

    return(result);
}


EdStatus SavePrefs(EdDataPtr ed, STRPTR name)
{
    return(WriteIFF(ed,name,&IFFPrefHeader,WritePrefs));
}


/*****************************************************************************/


#define NW_WIDTH     556
#define NW_HEIGHT    176
#define	NW_IDCMP     (IDCMP_MOUSEBUTTONS | IDCMP_MENUPICK | IDCMP_REFRESHWINDOW | IDCMP_INTUITICKS | BUTTONIDCMP | CHECKBOXIDCMP | SLIDERIDCMP | CYCLEIDCMP | TEXTIDCMP)
#define	NW_FLAGS     (WFLG_ACTIVATE | WFLG_DEPTHGADGET | WFLG_DRAGBAR | WFLG_SIMPLE_REFRESH)
#define NW_MINWIDTH  NW_WIDTH
#define NW_MINHEIGHT NW_HEIGHT
#define NW_MAXWIDTH  NW_WIDTH
#define NW_MAXHEIGHT NW_HEIGHT
#define ZOOMWIDTH    200

struct EdMenu far EM[] = {
    {NM_TITLE,  MSG_PROJECT_MENU,           EC_NOP, 0},
      {NM_ITEM, MSG_PROJECT_OPEN,           EC_OPEN, 0},
      {NM_ITEM, MSG_PROJECT_SAVE_AS,        EC_SAVEAS, 0},
      {NM_ITEM, MSG_NOTHING,                EC_NOP, 0},
      {NM_ITEM, MSG_PROJECT_QUIT,           EC_CANCEL, 0},

    {NM_TITLE,  MSG_EDIT_MENU,              EC_NOP, 0},
      {NM_ITEM, MSG_EDIT_RESET_TO_DEFAULTS, EC_RESETALL, 0},
      {NM_ITEM, MSG_EDIT_LAST_SAVED,        EC_LASTSAVED, 0},
      {NM_ITEM, MSG_EDIT_RESTORE,           EC_RESTORE, 0},

    {NM_TITLE,  MSG_OPTIONS_MENU,           EC_NOP, 0},
      {NM_ITEM, MSG_OPTIONS_SAVE_ICONS,     EC_SAVEICONS, CHECKIT|MENUTOGGLE},
      {NM_ITEM, MSG_PGFX_OPTIONS_METRIC,         EC_METRIC,    CHECKIT|MENUTOGGLE},

    {NM_END,    MSG_NOTHING,                EC_NOP, 0}
};

/* main display gadgets */
struct EdGadget far EG[] = {
    {BUTTON_KIND,   8,   159,  87,  14, MSG_SAVE_GAD,          EC_SAVE,    0},
    {BUTTON_KIND,   234, 159,  87,  14, MSG_USE_GAD,           EC_USE,     0},
    {BUTTON_KIND,   461, 159,  87,  14, MSG_CANCEL_GAD,        EC_CANCEL,  0},

    {CHECKBOX_KIND, 425, 18,   87,  14, MSG_PGFX_RED_GAD,           EC_RED,     0},
    {CHECKBOX_KIND, 425, 30,   87,  14, MSG_PGFX_GREEN_GAD,         EC_GREEN,   0},
    {CHECKBOX_KIND, 425, 42,   87,  14, MSG_PGFX_BLUE_GAD,          EC_BLUE,    0},
    {NUMBER_KIND,   490, 33,   36,  13, MSG_PGFX_COLORS_GAD,        EC_NOP,     PLACETEXT_ABOVE},

    {CYCLE_KIND,    127, 8,    176, 14, MSG_PGFX_DITHERING_GAD,     EC_DITHERING, 0},
    {CYCLE_KIND,    127, 22,   176, 14, MSG_PGFX_SCALING_GAD,       EC_SCALING,   0},
    {CYCLE_KIND,    127, 36,   176, 14, MSG_PGFX_IMAGE_GAD,         EC_IMAGE,     0},
    {CYCLE_KIND,    127, 50,   176, 14, MSG_PGFX_ASPECT_GAD,        EC_ASPECT,    0},
    {CYCLE_KIND,    127, 64,   176, 14, MSG_PGFX_SHADE_GAD,         EC_SHADE,     0},

    {SLIDER_KIND,   151, 84,   152, 11, MSG_PGFX_THRESHOLD_GAD,     EC_THRESHOLD, 0},
    {SLIDER_KIND,   151, 97,   152, 11, MSG_PGFX_DENSITY_GAD,       EC_DENSITY,   0},

    {CHECKBOX_KIND, 127, 117,  87,  14, MSG_PGFX_SMOOTHING_GAD,     EC_SMOOTHING,     PLACETEXT_RIGHT},
    {CHECKBOX_KIND, 127, 131,  87,  14, MSG_PGFX_CENTERPICTURE_GAD, EC_CENTERPICTURE, PLACETEXT_RIGHT},

    {INTEGER_KIND,  494, 65,   54,  14, MSG_NOTHING,           EC_LEFTOFFSET,    0},

    {CYCLE_KIND,    412, 99,   136, 14, MSG_PGFX_TYPE_GAD,          EC_TYPE,     0},
    {INTEGER_KIND,  494, 115,  54,  14, MSG_NOTHING,           EC_WIDTH,    0},
    {INTEGER_KIND,  494, 131,  54,  14, MSG_NOTHING,           EC_HEIGHT,   0}
};


/*****************************************************************************/


BOOL CreateDisplay(EdDataPtr ed)
{
UWORD              zoomSize[4];
struct LocaleInfo *li;

    zoomSize[0] = -1;
    zoomSize[1] = -1;
    zoomSize[2] = ZOOMWIDTH;
    zoomSize[3] = ed->ed_Screen->WBorTop + ed->ed_Screen->Font->ta_YSize + 1;

    li = &ed->ed_LocaleInfo;
    ed->ed_DitheringLabels[0] = GetString(li,MSG_PGFX_ORDERED);
    ed->ed_DitheringLabels[1] = GetString(li,MSG_PGFX_HALFTONE);
    ed->ed_DitheringLabels[2] = GetString(li,MSG_PGFX_FLOYDSTEINBERG);
    ed->ed_ScalingLabels[0]   = GetString(li,MSG_PGFX_FRACTION);
    ed->ed_ScalingLabels[1]   = GetString(li,MSG_PGFX_INTEGER);
    ed->ed_ImageLabels[0]     = GetString(li,MSG_PGFX_POSITIVE);
    ed->ed_ImageLabels[1]     = GetString(li,MSG_PGFX_NEGATIVE);
    ed->ed_AspectLabels[0]    = GetString(li,MSG_PGFX_HORIZONTAL);
    ed->ed_AspectLabels[1]    = GetString(li,MSG_PGFX_VERTICAL);
    ed->ed_ShadeLabels[0]     = GetString(li,MSG_PGFX_BLACK_AND_WHITE);
    ed->ed_ShadeLabels[1]     = GetString(li,MSG_PGFX_GREY_SCALE_1);
    ed->ed_ShadeLabels[2]     = GetString(li,MSG_PGFX_GREY_SCALE_2);
    ed->ed_ShadeLabels[3]     = GetString(li,MSG_PGFX_COLOR);
    ed->ed_TypeLabels[0]      = GetString(li,MSG_PGFX_IGNORE);
    ed->ed_TypeLabels[1]      = GetString(li,MSG_PGFX_BOUNDED);
    ed->ed_TypeLabels[2]      = GetString(li,MSG_PGFX_ABSOLUTE);
    ed->ed_TypeLabels[3]      = GetString(li,MSG_PGFX_PIXELS);
    ed->ed_TypeLabels[4]      = GetString(li,MSG_PGFX_MULTIPLY);

    ed->ed_LastAdded = CreateContext(&ed->ed_Gadgets);
    DoPrefsGadget(ed,&EG[0],NULL,TAG_DONE);
    DoPrefsGadget(ed,&EG[1],NULL,TAG_DONE);
    DoPrefsGadget(ed,&EG[2],NULL,TAG_DONE);

    RenderGadgets(ed);

    if ((ed->ed_LastAdded)
    &&  (ed->ed_Menus = CreatePrefsMenus(ed,EM))
    &&  (ed->ed_Window = OpenPrefsWindow(ed,WA_InnerWidth,  NW_WIDTH,
                                            WA_InnerHeight, NW_HEIGHT,
                                            WA_MinWidth,    NW_MINWIDTH,
                                            WA_MinHeight,   NW_MINHEIGHT,
                                            WA_MaxWidth,    NW_MAXWIDTH,
                                            WA_MaxHeight,   NW_MAXHEIGHT,
                                            WA_IDCMP,       NW_IDCMP,
                                            WA_Flags,       NW_FLAGS,
                                            WA_Zoom,        zoomSize,
                                            WA_AutoAdjust,  TRUE,
                                            WA_PubScreen,   ed->ed_Screen,
                                            WA_Title,       GetString(&ed->ed_LocaleInfo,MSG_PGFX_NAME),
                                            WA_NewLookMenus,TRUE,
                                            WA_Gadgets,     ed->ed_Gadgets,
                                            TAG_DONE)))
    {
        return(TRUE);
    }

    DisposeDisplay(ed);
    return(FALSE);
}


/*****************************************************************************/


VOID DisposeDisplay(EdDataPtr ed)
{
    if (ed->ed_Window)
    {
        ClearMenuStrip(ed->ed_Window);
        CloseWindow(ed->ed_Window);
    }
    FreeMenus(ed->ed_Menus);
    FreeGadgets(ed->ed_Gadgets);
}


/*****************************************************************************/


ULONG GetColors(EdDataPtr ed)
{
UWORD count;

    count = 0;
    if (ed->ed_PrefsWork.pg_ColorCorrect & PCCF_RED)
        count++;

    if (ed->ed_PrefsWork.pg_ColorCorrect & PCCF_GREEN)
        count++;

    if (ed->ed_PrefsWork.pg_ColorCorrect & PCCF_BLUE)
        count++;

    return((ULONG)(4096-count*308));
}


/*****************************************************************************/


ULONG GetMM(EdDataPtr ed, ULONG tenths)
{
    if (!ed->ed_Metric)
        return(tenths);

    return((tenths*3050000)/1200000);
}


/*****************************************************************************/


ULONG GetTenths(EdDataPtr ed, ULONG mm)
{
    if (!ed->ed_Metric)
        return(mm);

    return((mm*1200000+3049999)/3050000);
}


/*****************************************************************************/


VOID DrawBB(EdDataPtr ed, SHORT x, SHORT y,
                                     SHORT w, SHORT h, ULONG tags, ...)
{
    DrawBevelBoxA(ed->ed_Window->RPort,x+ed->ed_Window->BorderLeft,
                                       y+ed->ed_Window->BorderTop,
                                       w,h,(struct TagItem *)&tags);
}


/*****************************************************************************/


VOID PutLine(EdDataPtr ed, struct RastPort *rp, AppStringsID id,
             UWORD x, UWORD y, UWORD w, BOOL center)
{
STRPTR str;
UWORD  len;

    str = GetString(&ed->ed_LocaleInfo,id);
    len = strlen(str);

    if (center)
        Move(rp,(w-TextLength(rp,str,len)) / 2 + window->BorderLeft + x,
                window->BorderTop+y);
    else
        Move(rp,w-TextLength(rp,str,len) + window->BorderLeft + x,
                window->BorderTop+y);

    Text(rp,str,len);
}


/*****************************************************************************/


VOID RenderWidthHeight(EdDataPtr ed)
{
AppStringsID      width,left;
struct RastPort  *rp;

    rp = window->RPort;
    SetAPen(rp,ed->ed_DrawInfo->dri_Pens[TEXTPEN]);
    SetBPen(rp,ed->ed_DrawInfo->dri_Pens[BACKGROUNDPEN]);

    left = MSG_PGFX_LEFTOFFSET0_GAD;
    if (!ed->ed_Metric)
        left = MSG_PGFX_LEFTOFFSET1_GAD;

    PutLine(ed,rp,left,0,74,486,FALSE);

    if ((ed->ed_PrefsWork.pg_Dimensions == PD_BOUNDED) || (ed->ed_PrefsWork.pg_Dimensions == PD_ABSOLUTE))
    {
        if (ed->ed_Metric)
            width = MSG_PGFX_WIDTH1_GAD;
        else
            width = MSG_PGFX_WIDTH2_GAD;
    }
    else
    {
        width = MSG_PGFX_WIDTH0_GAD+(ed->ed_PrefsWork.pg_Dimensions*2);
    }

    PutLine(ed,rp,width,0,124,486,FALSE);
    PutLine(ed,rp,width+1,0,140,486,FALSE);
}


/*****************************************************************************/


VOID RenderDisplay(EdDataPtr ed)
{
struct RastPort *rp;

    rp = window->RPort;
    SetAPen(rp,ed->ed_DrawInfo->dri_Pens[HIGHLIGHTTEXTPEN]);
    SetBPen(rp,ed->ed_DrawInfo->dri_Pens[BACKGROUNDPEN]);

    PutLine(ed,rp,MSG_PGFX_COLORCORRECT_HDR,307,10,245,TRUE);

    DrawBB(ed,464,33,84,13,GT_VisualInfo,ed->ed_VisualInfo,
                           GTBB_Recessed,TRUE,
                           TAG_DONE);

    PutLine(ed,rp,MSG_PGFX_LIMITS_HDR,307,94,245,TRUE);

    RenderWidthHeight(ed);
}


/*****************************************************************************/


/* gadgets that are affected by the state of the Shade gadget */
VOID RenderShadeGadgets(EdDataPtr ed)
{
    ed->ed_Red = DoPrefsGadget(ed,&EG[3],ed->ed_Red,
                                         GTCB_Checked, ed->ed_PrefsWork.pg_ColorCorrect & PCCF_RED,
                                         GA_Disabled,  ed->ed_PrefsWork.pg_Shade != NEW_PS_COLOR,
                                         TAG_DONE);

    ed->ed_Green = DoPrefsGadget(ed,&EG[4],ed->ed_Green,
                                           GTCB_Checked, ed->ed_PrefsWork.pg_ColorCorrect & PCCF_GREEN,
                                           GA_Disabled,  ed->ed_PrefsWork.pg_Shade != NEW_PS_COLOR,
                                           TAG_DONE);

    ed->ed_Blue = DoPrefsGadget(ed,&EG[5],ed->ed_Blue,
                                          GTCB_Checked, ed->ed_PrefsWork.pg_ColorCorrect & PCCF_BLUE,
                                          GA_Disabled,  ed->ed_PrefsWork.pg_Shade != NEW_PS_COLOR,
                                         TAG_DONE);

    ed->ed_Threshold = DoPrefsGadget(ed,&EG[12],ed->ed_Threshold,
                                                GTSL_Level,       ed->ed_PrefsWork.pg_Threshold,
                                                GTSL_Min,         1,
                                                GTSL_Max,         15,
                                                GTSL_MaxLevelLen, 2,
                                                GTSL_LevelFormat, "%2lu",
                                                GA_RelVerify,     TRUE,
                                                GA_Immediate,     TRUE,
                                                TAG_DONE);
}


/*****************************************************************************/


VOID RenderGadgets(EdDataPtr ed)
{
ULONG num;

    RenderShadeGadgets(ed);

    ed->ed_Colors = DoPrefsGadget(ed,&EG[6],ed->ed_Colors,
                                            GTNM_Number,GetColors(ed),
                                            TAG_DONE);

    ed->ed_Dithering = DoPrefsGadget(ed,&EG[7],ed->ed_Dithering,
                                               GTCY_Active, ed->ed_PrefsWork.pg_Dithering,
                                               GTCY_Labels, ed->ed_DitheringLabels,
					       TAG_DONE);

    ed->ed_Scaling = DoPrefsGadget(ed,&EG[8],ed->ed_Scaling,
                                             GTCY_Active, (ed->ed_PrefsWork.pg_GraphicFlags & PGFF_INTEGER_SCALING) >> 1,
                                             GTCY_Labels, ed->ed_ScalingLabels,
					     TAG_DONE);

    ed->ed_Image = DoPrefsGadget(ed,&EG[9],ed->ed_Image,
					   GTCY_Active, ed->ed_PrefsWork.pg_Image,
                                           GTCY_Labels, ed->ed_ImageLabels,
                                           TAG_DONE);

    ed->ed_Aspect = DoPrefsGadget(ed,&EG[10],ed->ed_Aspect,
                                             GTCY_Active, ed->ed_PrefsWork.pg_Aspect,
                                             GTCY_Labels, ed->ed_AspectLabels,
					     TAG_DONE);

    ed->ed_Shade = DoPrefsGadget(ed,&EG[11],ed->ed_Shade,
                                            GTCY_Active, ed->ed_PrefsWork.pg_Shade,
                                            GTCY_Labels, ed->ed_ShadeLabels,
					    TAG_DONE);

    ed->ed_Density = DoPrefsGadget(ed,&EG[13],ed->ed_Density,
                                              GTSL_Level,       ed->ed_PrefsWork.pg_PrintDensity,
    					      GTSL_Min,         1,
    					      GTSL_Max,         7,
                                              GTSL_MaxLevelLen, 2,
                                              GTSL_LevelFormat, "%2lu",
                                              GA_RelVerify,     TRUE,
                                              GA_Immediate,     TRUE,
                                              TAG_DONE);

    ed->ed_Smoothing = DoPrefsGadget(ed,&EG[14],ed->ed_Smoothing,
                                                GTCB_Checked, ed->ed_PrefsWork.pg_GraphicFlags & PGFF_ANTI_ALIAS,
                                                GA_Disabled,  ed->ed_PrefsWork.pg_Dithering == PD_FLOYD,
                                                TAG_DONE);

    ed->ed_CenterPicture = DoPrefsGadget(ed,&EG[15],ed->ed_CenterPicture,
                                                    GTCB_Checked,ed->ed_PrefsWork.pg_GraphicFlags & PGFF_CENTER_IMAGE,
                                                    TAG_DONE);

    ed->ed_LeftOffset = DoPrefsGadget(ed,&EG[16],ed->ed_LeftOffset,
                                                 GTIN_Number,   GetMM(ed,ed->ed_PrefsWork.pg_PrintXOffset),
                                                 GA_Disabled,   ed->ed_PrefsWork.pg_GraphicFlags & PGFF_CENTER_IMAGE,
                                                 GTIN_MaxChars, 4,
						 TAG_DONE);

    ed->ed_Type = DoPrefsGadget(ed,&EG[17],ed->ed_Type,
                                           GTCY_Active, ed->ed_PrefsWork.pg_Dimensions,
                                           GTCY_Labels, ed->ed_TypeLabels,
                                           TAG_DONE);

    num = ed->ed_PrefsWork.pg_PrintMaxWidth;
    if ((ed->ed_PrefsWork.pg_Dimensions == PD_BOUNDED) || (ed->ed_PrefsWork.pg_Dimensions == PD_ABSOLUTE))
        num = GetMM(ed,num);

    ed->ed_Width = DoPrefsGadget(ed,&EG[18],ed->ed_Width,
                                            GTIN_Number,   num,
                                            GA_Disabled,   ed->ed_PrefsWork.pg_Dimensions == PD_IGNORE,
                                            GTIN_MaxChars, 4,
                                            TAG_DONE);

    num = ed->ed_PrefsWork.pg_PrintMaxHeight;
    if ((ed->ed_PrefsWork.pg_Dimensions == PD_BOUNDED) || (ed->ed_PrefsWork.pg_Dimensions == PD_ABSOLUTE))
        num = GetMM(ed,num);

    ed->ed_Height = DoPrefsGadget(ed,&EG[19],ed->ed_Height,
                                             GTIN_Number,   num,
                                             GA_Disabled,   ed->ed_PrefsWork.pg_Dimensions == PD_IGNORE,
                                             GTIN_MaxChars, 4,
                                             TAG_DONE);
}


/*****************************************************************************/


VOID ProcessTextGadget(EdDataPtr ed, EdCommand ec, BOOL screenStuff)
{
BOOL           shift;
LONG           num;
struct Gadget *act;
BOOL           beep;

    shift = (IEQUALIFIER_LSHIFT|IEQUALIFIER_RSHIFT) & ed->ed_CurrentMsg.Qualifier;
    beep  = FALSE;

    switch (ec)
    {
        case EC_LEFTOFFSET     : num = ((struct StringInfo *)ed->ed_LeftOffset->SpecialInfo)->LongInt;
                                 if (num < 0)
                                 {
                                     num  = 0;
                                     act  = ed->ed_LeftOffset;
                                     beep = TRUE;
                                 }
                                 else if (num > 2539)
                                 {
                                     num  = 2539;
                                     act  = ed->ed_LeftOffset;
                                     beep = TRUE;
                                 }
                                 else
                                 {
                                     if (shift)
                                         act = ed->ed_Height;
                                     else
                                         act = ed->ed_Width;
                                 }

                                 ed->ed_PrefsWork.pg_PrintXOffset = num;

				 if (screenStuff)
                                     SetGadgetAttr(ed,ed->ed_LeftOffset,GTIN_Number,GetMM(ed,num),
                                                                        TAG_DONE);
                                 break;

            case EC_WIDTH      : num = ((struct StringInfo *)ed->ed_Width->SpecialInfo)->LongInt;
                                 if (num < 0)
                                 {
                                     num  = 0;
                                     act  = ed->ed_Width;
                                     beep = TRUE;
                                 }
                                 else if (num > 2539)
                                 {
                                     num  = 2539;
                                     act  = ed->ed_Width;
                                     beep = TRUE;
                                 }
                                 else
                                 {
                                     if (shift)
                                         act = ed->ed_LeftOffset;
                                     else
                                         act = ed->ed_Height;
                                 }

                                 if ((ed->ed_PrefsWork.pg_Dimensions == PD_BOUNDED) || (ed->ed_PrefsWork.pg_Dimensions == PD_ABSOLUTE))
                                 {
                                     num = GetTenths(ed,num);
                                     if (screenStuff)
                                         SetGadgetAttr(ed,ed->ed_Width,GTIN_Number,GetMM(ed,num),
                                                                       TAG_DONE);
                                 }
                                 else
                                 {
                                     if (screenStuff)
                                         SetGadgetAttr(ed,ed->ed_Width,GTIN_Number,num,
                                                                       TAG_DONE);
                                 }
                                 ed->ed_PrefsWork.pg_PrintMaxWidth = num;
                                 break;

        case EC_HEIGHT         : num = ((struct StringInfo *)ed->ed_Height->SpecialInfo)->LongInt;
                                 if (num < 0)
                                 {
                                     num  = 0;
                                     act  = ed->ed_Height;
                                     beep = TRUE;
                                 }
                                 else if (num > 2539)
                                 {
                                     num  = 2539;
                                     act  = ed->ed_Height;
                                     beep = TRUE;
                                 }
                                 else
                                 {
                                     if (shift)
                                         act = ed->ed_Width;
                                     else
                                         act = ed->ed_LeftOffset;
                                 }

                                 if ((ed->ed_PrefsWork.pg_Dimensions == PD_BOUNDED) || (ed->ed_PrefsWork.pg_Dimensions == PD_ABSOLUTE))
                                 {
                                     num = GetTenths(ed,num);
                                     if (screenStuff)
                                         SetGadgetAttr(ed,ed->ed_Height,GTIN_Number,GetMM(ed,num),
                                                                        TAG_DONE);
                                 }
                                 else
                                 {
                                     if (screenStuff)
                                         SetGadgetAttr(ed,ed->ed_Height,GTIN_Number,num,
                                                                        TAG_DONE);
                                 }
                                 ed->ed_PrefsWork.pg_PrintMaxHeight = num;
                                 break;
    }

    if (screenStuff)
    {
        if (!(act->Flags & GFLG_DISABLED))
        {
            ActivateGadget(act,window,NULL);
        }

        if (beep)
        {
            DisplayBeep(window->WScreen);
        }
    }
}


/*****************************************************************************/


VOID SyncTextGadgets(EdDataPtr ed)
{
    ProcessTextGadget(ed,EC_LEFTOFFSET,FALSE);
    ProcessTextGadget(ed,EC_WIDTH,FALSE);
    ProcessTextGadget(ed,EC_HEIGHT,FALSE);
}


/*****************************************************************************/


VOID ProcessSpecialCommand(EdDataPtr ed, EdCommand ec)
{
UWORD          icode;
struct Gadget *gadget;

    if (ed->ed_CurrentMsg.Class == IDCMP_MOUSEMOVE)
        return;

    icode  = ed->ed_CurrentMsg.Code;
    gadget = ed->ed_CurrentMsg.IAddress;

    switch (ec)
    {
	case EC_RED            : ed->ed_PrefsWork.pg_ColorCorrect &= ~(PCCF_RED);
	                         if (gadget->Flags & SELECTED)
                                     ed->ed_PrefsWork.pg_ColorCorrect |= PCCF_RED;

                                 SetGadgetAttr(ed,ed->ed_Colors,GTNM_Number,GetColors(ed),
                                                                TAG_DONE);
                                 break;

	case EC_GREEN          : ed->ed_PrefsWork.pg_ColorCorrect &= ~(PCCF_GREEN);
	                         if (gadget->Flags & SELECTED)
                                     ed->ed_PrefsWork.pg_ColorCorrect |= PCCF_GREEN;

                                 SetGadgetAttr(ed,ed->ed_Colors,GTNM_Number,GetColors(ed),
                                                                TAG_DONE);
                                 break;

	case EC_BLUE           : ed->ed_PrefsWork.pg_ColorCorrect &= ~(PCCF_BLUE);
	                         if (gadget->Flags & SELECTED)
                                     ed->ed_PrefsWork.pg_ColorCorrect |= PCCF_BLUE;

                                 SetGadgetAttr(ed,ed->ed_Colors,GTNM_Number,GetColors(ed),
                                                                TAG_DONE);
                                 break;

        case EC_DITHERING      : ed->ed_PrefsWork.pg_Dithering = icode;
                                 if (icode == PD_FLOYD)
                                 {
                                     ed->ed_PrefsWork.pg_GraphicFlags &= ~(PGFF_ANTI_ALIAS);
                                 }

                                 SetGadgetAttr(ed,ed->ed_Smoothing,GA_Disabled,icode == PD_FLOYD,TAG_DONE);
                                 break;

        case EC_SCALING        : if (icode == 0)
                                     ed->ed_PrefsWork.pg_GraphicFlags &= ~PGFF_INTEGER_SCALING;
                                 else
                                     ed->ed_PrefsWork.pg_GraphicFlags |= PGFF_INTEGER_SCALING;
                                 break;

        case EC_IMAGE          : ed->ed_PrefsWork.pg_Image = icode;
                                 break;

        case EC_ASPECT         : ed->ed_PrefsWork.pg_Aspect = icode;
                                 break;

        case EC_SHADE          : ed->ed_PrefsWork.pg_Shade = icode;
                                 RenderShadeGadgets(ed);
                                 break;

        case EC_THRESHOLD      : ed->ed_PrefsWork.pg_Threshold = icode;
                                 break;

        case EC_DENSITY        : ed->ed_PrefsWork.pg_PrintDensity = icode;
                                 break;

        case EC_SMOOTHING      : ed->ed_PrefsWork.pg_GraphicFlags &= ~(PGFF_ANTI_ALIAS);
                                 if (gadget->Flags & SELECTED)
                                     ed->ed_PrefsWork.pg_GraphicFlags |= PGFF_ANTI_ALIAS;
                                 break;

        case EC_CENTERPICTURE  : ed->ed_PrefsWork.pg_GraphicFlags &= ~(PGFF_CENTER_IMAGE);
                                 if (gadget->Flags & SELECTED)
                                     ed->ed_PrefsWork.pg_GraphicFlags |= PGFF_CENTER_IMAGE;

                                 SetGadgetAttr(ed,ed->ed_LeftOffset,GA_Disabled,ed->ed_PrefsWork.pg_GraphicFlags & PGFF_CENTER_IMAGE,TAG_DONE);
                                 break;

        case EC_LEFTOFFSET     :
        case EC_WIDTH          :
        case EC_HEIGHT         : ProcessTextGadget(ed,ec,TRUE);
                                 break;

        case EC_TYPE           : ed->ed_PrefsWork.pg_Dimensions = icode;
    				 SetGadgetAttr(ed,ed->ed_Width,GA_Disabled,ed->ed_PrefsWork.pg_Dimensions == PD_IGNORE,TAG_DONE);
    				 SetGadgetAttr(ed,ed->ed_Height,GA_Disabled,ed->ed_PrefsWork.pg_Dimensions == PD_IGNORE,TAG_DONE);
                                 RenderWidthHeight(ed);
                                 break;

        case EC_METRIC         : ed->ed_Metric = !ed->ed_Metric;
        			 RenderWidthHeight(ed);
        			 RenderGadgets(ed);
				 break;

        default                : break;
    }
}


/*****************************************************************************/


VOID GetSpecialCmdState(EdDataPtr ed, EdCommand ec, CmdStatePtr state)
{
    state->cs_Available = TRUE;
    state->cs_Selected  = FALSE;

    if (ec == EC_METRIC)
        state->cs_Selected = ed->ed_Metric;
}
@


38.13
log
@*** empty log message ***
@
text
@a207 2
#define NW_LEFT      0
#define NW_TOP       0
d276 2
a277 2
    zoomSize[0] = NW_LEFT;
    zoomSize[1] = NW_TOP;
d310 1
a310 3
    &&  (ed->ed_Window = OpenPrefsWindow(ed,WA_Left,        NW_LEFT,
                                            WA_Top,         NW_TOP,
                                            WA_InnerWidth,  NW_WIDTH,
@


38.12
log
@*** empty log message ***
@
text
@a513 1
                                                GA_Disabled,      ed->ed_PrefsWork.pg_Shade != PS_BW,
@


38.11
log
@Things are ordered better in the Shading gadget
@
text
@d90 7
d145 1
a145 1
            ed->ed_PrefsWork.pg_Shade = PS_GREY_SCALE2;
d149 1
a149 1
             ed->ed_PrefsWork.pg_Shade = PS_COLOR;
d171 1
a171 1
    if (ed->ed_PrefsWork.pg_Shade == PS_COLOR)
d173 1
a173 1
        ed->ed_PrefsWork.pg_Shade = PS_GREY_SCALE2;
d175 1
a175 1
    else if (ed->ed_PrefsWork.pg_Shade == PS_GREY_SCALE2)
d177 1
a177 1
        ed->ed_PrefsWork.pg_Shade = PS_COLOR;
d188 1
a188 1
         ed->ed_PrefsWork.pg_Shade = PS_GREY_SCALE2;
d192 1
a192 1
         ed->ed_PrefsWork.pg_Shade = PS_COLOR;
d499 1
a499 1
                                         GA_Disabled,  ed->ed_PrefsWork.pg_Shade != PS_COLOR,
d504 1
a504 1
                                           GA_Disabled,  ed->ed_PrefsWork.pg_Shade != PS_COLOR,
d509 1
a509 1
                                          GA_Disabled,  ed->ed_PrefsWork.pg_Shade != PS_COLOR,
@


38.10
log
@*** empty log message ***
@
text
@d135 9
d145 1
d162 12
d177 1
a177 1
                return(ES_NORMAL);
d179 10
a188 1
    return(ES_IFFERROR);
d288 2
a289 2
    ed->ed_ShadeLabels[2]     = GetString(li,MSG_PGFX_COLOR);
    ed->ed_ShadeLabels[3]     = GetString(li,MSG_PGFX_GREY_SCALE_2);
@


38.9
log
@*** empty log message ***
@
text
@d585 1
d587 2
a588 2
    act     = NULL;
    shift   = (IEQUALIFIER_LSHIFT|IEQUALIFIER_RSHIFT) & ed->ed_CurrentMsg.Qualifier;
d595 3
a597 2
                                     num = 0;
                                     act = ed->ed_LeftOffset;
d601 3
a603 2
                                     num = 2539;
                                     act = ed->ed_LeftOffset;
d623 3
a625 2
                                     num = 0;
                                     act = ed->ed_Width;
d629 3
a631 2
                                     num = 2539;
                                     act = ed->ed_Width;
d660 3
a662 2
                                     num = 0;
                                     act = ed->ed_Height;
d666 3
a668 2
                                     num = 2539;
                                     act = ed->ed_Height;
a692 2

        default                : break;
d697 1
a697 1
        if (act)
d699 1
a699 4
            if (!(act->Flags & GFLG_DISABLED))
            {
                ActivateGadget(act,window,NULL);
            }
d701 2
a702 1
        else
@


38.8
log
@Fixed excessive DisplayBeeps()
@
text
@a89 8
VOID ProcessArgs(EdDataPtr ed, struct DiskObject *diskObj)
{
}


/*****************************************************************************/


a128 8
VOID CleanUpEdData(EdDataPtr ed)
{
}


/*****************************************************************************/


a818 9
}


/*****************************************************************************/


EdCommand GetCommand(EdDataPtr ed)
{
    return(EC_NOP);
@


38.7
log
@Added SyncTextGadgets() support
Changes for new pe_iff
@
text
@d709 1
d711 1
d713 2
d716 1
d718 1
@


38.6
log
@Now uses DoPrefsGadget instead of CreatePrefsGadget for better look upon window
  opening
@
text
@d64 26
d159 1
a159 1
    return(ReadIFF(ed,name,ReadPrefs));
d179 1
a179 1
    return(WriteIFF(ed,name,WritePrefs));
d234 2
a235 2
    {SLIDER_KIND,   143, 84,   160, 11, MSG_PGFX_THRESHOLD_GAD,     EC_THRESHOLD, 0},
    {SLIDER_KIND,   143, 97,   160, 11, MSG_PGFX_DENSITY_GAD,       EC_DENSITY,   0},
a260 5
    if (!(ed->ed_Menus = CreatePrefsMenus(ed,EM)))
    {
	return(FALSE);
    }

d288 26
a313 30
    if (!ed->ed_LastAdded)
    {
        DisposeDisplay(ed);
        return(FALSE);
    }

    if (!(ed->ed_Window = OpenPrefsWindow(ed,WA_Left,        NW_LEFT,
                                             WA_Top,         NW_TOP,
                                             WA_InnerWidth,  NW_WIDTH,
                                             WA_InnerHeight, NW_HEIGHT,
                                             WA_MinWidth,    NW_MINWIDTH,
                                             WA_MinHeight,   NW_MINHEIGHT,
                                             WA_MaxWidth,    NW_MAXWIDTH,
                                             WA_MaxHeight,   NW_MAXHEIGHT,
                                             WA_IDCMP,       NW_IDCMP,
                                             WA_Flags,       NW_FLAGS,
                                             WA_Zoom,        zoomSize,
                                             WA_AutoAdjust,  TRUE,
                                             WA_PubScreen,   ed->ed_Screen,
                                             WA_Title,       GetString(&ed->ed_LocaleInfo,MSG_PGFX_NAME),
                                             WA_NewLookMenus,TRUE,
                                             WA_Gadgets,     ed->ed_Gadgets,
                                             TAG_DONE)))
    {
        DisposeDisplay(ed);
	return(FALSE);
    }

    return(TRUE);
}
d541 1
a541 1
    ed->ed_Density = DoPrefsGadget(ed,&EG[12],ed->ed_Density,
d596 135
d733 2
a734 5
UWORD            icode;
BOOL             shift;
LONG             num;
struct Gadget   *act;
struct Gadget   *gadget;
d739 2
a740 4
    icode   = ed->ed_CurrentMsg.Code;
    gadget  = ed->ed_CurrentMsg.IAddress;
    act     = NULL;
    shift   = (IEQUALIFIER_LSHIFT|IEQUALIFIER_RSHIFT) & ed->ed_CurrentMsg.Qualifier;
d811 3
a813 27
        case EC_LEFTOFFSET     : if (shift)
                                     act = ed->ed_Height;
                                 else
                                     act = ed->ed_Width;

                                 num = ((struct StringInfo *)ed->ed_LeftOffset->SpecialInfo)->LongInt;
                                 if (num < 0)
                                 {
                                     num = 0;
                                     act = NULL;
                                 }

                                 if (num > 2539)
                                 {
                                     num = 2539;
                                     act = NULL;
                                 }

                                 num = GetTenths(ed,num);

                                 ed->ed_PrefsWork.pg_PrintXOffset = num;

                                 SetGadgetAttr(ed,ed->ed_LeftOffset,GTIN_Number,GetMM(ed,num),
                                                                    TAG_DONE);

                                 if (!act)
                                     DisplayBeep(window->WScreen);
a821 70
        case EC_WIDTH          : if (shift)
                                     act = ed->ed_LeftOffset;
                                 else
                                     act = ed->ed_Height;

                                 num = ((struct StringInfo *)ed->ed_Width->SpecialInfo)->LongInt;
                                 if (num < 0)
                                 {
                                     num = 0;
                                     act = NULL;
                                 }

                                 if (num > 2539)
                                 {
                                     num = 2539;
                                     act = NULL;
                                 }

                                 if ((ed->ed_PrefsWork.pg_Dimensions == PD_BOUNDED) || (ed->ed_PrefsWork.pg_Dimensions == PD_ABSOLUTE))
                                 {
                                     num = GetTenths(ed,num);
                                     SetGadgetAttr(ed,ed->ed_Width,GTIN_Number,GetMM(ed,num),
                                                                   TAG_DONE);
                                 }
                                 else
                                 {
                                     SetGadgetAttr(ed,ed->ed_Width,GTIN_Number,num,
                                                                   TAG_DONE);
                                 }
                                 ed->ed_PrefsWork.pg_PrintMaxWidth = num;

                                 if (!act)
                                     DisplayBeep(window->WScreen);
                                 break;

        case EC_HEIGHT         : if (shift)
                                     act = ed->ed_Width;
                                 else
                                     act = ed->ed_LeftOffset;

                                 num = ((struct StringInfo *)ed->ed_Height->SpecialInfo)->LongInt;
                                 if (num < 0)
                                 {
                                     num = 0;
                                     act = NULL;
                                 }

                                 if (num > 2539)
                                 {
                                     num = 2539;
                                     act = NULL;
                                 }

                                 if ((ed->ed_PrefsWork.pg_Dimensions == PD_BOUNDED) || (ed->ed_PrefsWork.pg_Dimensions == PD_ABSOLUTE))
                                 {
                                     num = GetTenths(ed,num);
                                     SetGadgetAttr(ed,ed->ed_Height,GTIN_Number,GetMM(ed,num),
                                                                    TAG_DONE);
                                 }
                                 else
                                 {
                                     SetGadgetAttr(ed,ed->ed_Height,GTIN_Number,num,
                                                                    TAG_DONE);
                                 }
                                 ed->ed_PrefsWork.pg_PrintMaxHeight = num;

                                 if (!act)
                                     DisplayBeep(window->WScreen);
                                 break;

a828 3

    if (act && (!(act->Flags & GFLG_DISABLED)))
        ActivateGadget(act,window,NULL);
@


38.5
log
@Now uses WA_Gadgets to add the gadgets to the window
@
text
@d261 3
a263 3
    CreatePrefsGadget(ed,&EG[0],TAG_DONE);
    CreatePrefsGadget(ed,&EG[1],TAG_DONE);
    CreatePrefsGadget(ed,&EG[2],TAG_DONE);
d265 1
a265 16
    ed->ed_Red       = CreatePrefsGadget(ed,&EG[3],TAG_DONE);
    ed->ed_Green     = CreatePrefsGadget(ed,&EG[4],TAG_DONE);
    ed->ed_Blue      = CreatePrefsGadget(ed,&EG[5],TAG_DONE);
    ed->ed_Colors    = CreatePrefsGadget(ed,&EG[6],TAG_DONE);

    ed->ed_Dithering = CreatePrefsGadget(ed,&EG[7],GTCY_Labels, ed->ed_DitheringLabels,
						   GTCY_Active, ed->ed_PrefsWork.pg_Dithering,
                                                   TAG_DONE);

    ed->ed_Scaling   = CreatePrefsGadget(ed,&EG[8],GTCY_Labels, ed->ed_ScalingLabels,
						   GTCY_Active, (ed->ed_PrefsWork.pg_GraphicFlags & PGFF_INTEGER_SCALING) >> 1,
                                                   TAG_DONE);

    ed->ed_Image     = CreatePrefsGadget(ed,&EG[9],GTCY_Labels, ed->ed_ImageLabels,
						   GTCY_Active, ed->ed_PrefsWork.pg_Image,
                                                   TAG_DONE);
a266 45
    ed->ed_Aspect    = CreatePrefsGadget(ed,&EG[10],GTCY_Labels, ed->ed_AspectLabels,
						    GTCY_Active, ed->ed_PrefsWork.pg_Aspect,
                                                    TAG_DONE);

    ed->ed_Shade     = CreatePrefsGadget(ed,&EG[11],GTCY_Labels, ed->ed_ShadeLabels,
						    GTCY_Active, ed->ed_PrefsWork.pg_Shade,
                                                    TAG_DONE);

    ed->ed_Threshold = CreatePrefsGadget(ed,&EG[12],GTSL_Level,       ed->ed_PrefsWork.pg_Threshold,
                                                    GTSL_MaxLevelLen, 2,
                                                    GTSL_LevelFormat, "%2lu",
                                                    GA_RelVerify,     TRUE,
                                                    GA_Immediate,     TRUE,
    						    GTSL_Min,         1,
    						    GTSL_Max,         15,
                                                    TAG_DONE);

    ed->ed_Density   = CreatePrefsGadget(ed,&EG[13],GTSL_Level,       ed->ed_PrefsWork.pg_PrintDensity,
                                                    GTSL_MaxLevelLen, 2,
                                                    GTSL_LevelFormat, "%2lu",
                                                    GA_RelVerify,     TRUE,
                                                    GA_Immediate,     TRUE,
    						    GTSL_Min,         1,
    						    GTSL_Max,         7,
                                                    TAG_DONE);

    ed->ed_Smoothing     = CreatePrefsGadget(ed,&EG[14],TAG_DONE);
    ed->ed_CenterPicture = CreatePrefsGadget(ed,&EG[15],TAG_DONE);

    ed->ed_LeftOffset    = CreatePrefsGadget(ed,&EG[16],GTIN_MaxChars, 4,
							GTIN_Number,   GetMM(ed,ed->ed_PrefsWork.pg_PrintXOffset),
                                                        TAG_DONE);

    ed->ed_Type          = CreatePrefsGadget(ed,&EG[17],GTCY_Labels, ed->ed_TypeLabels,
                                                        GTCY_Active, ed->ed_PrefsWork.pg_Dimensions,
                                                        TAG_DONE);

    ed->ed_Width         = CreatePrefsGadget(ed,&EG[18],GTIN_MaxChars, 4,
							GTIN_Number,   0,
                                                        TAG_DONE);

    ed->ed_Height        = CreatePrefsGadget(ed,&EG[19],GTIN_MaxChars, 4,
							GTIN_Number,   0,
                                                        TAG_DONE);

d362 12
d442 3
a444 3
    DrawPrefsBevelBox(ed,464,33,84,13, GT_VisualInfo,ed->ed_VisualInfo,
                                       GTBB_Recessed,TRUE,
                                       TAG_DONE);
d458 4
a461 3
    SetGadgetAttr(ed,ed->ed_Red,GTCB_Checked, ed->ed_PrefsWork.pg_ColorCorrect & PCCF_RED,
                                GA_Disabled,  ed->ed_PrefsWork.pg_Shade != PS_COLOR,
			        TAG_DONE);
d463 21
a483 12
    SetGadgetAttr(ed,ed->ed_Green,GTCB_Checked, ed->ed_PrefsWork.pg_ColorCorrect & PCCF_GREEN,
    				  GA_Disabled,  ed->ed_PrefsWork.pg_Shade != PS_COLOR,
			          TAG_DONE);

    SetGadgetAttr(ed,ed->ed_Blue,GTCB_Checked, ed->ed_PrefsWork.pg_ColorCorrect & PCCF_BLUE,
    				 GA_Disabled,  ed->ed_PrefsWork.pg_Shade != PS_COLOR,
			         TAG_DONE);

    SetGadgetAttr(ed,ed->ed_Threshold,GTSL_Level,  ed->ed_PrefsWork.pg_Threshold,
    				      GA_Disabled, ed->ed_PrefsWork.pg_Shade != PS_BW,
                                      TAG_DONE);
}
d495 3
a497 2
    SetGadgetAttr(ed,ed->ed_Colors,GTNM_Number,GetColors(ed),
			           TAG_DONE);
d499 43
a541 28
    SetGadgetAttr(ed,ed->ed_Dithering,GTCY_Active,ed->ed_PrefsWork.pg_Dithering,
				      TAG_DONE);

    SetGadgetAttr(ed,ed->ed_Scaling,GTCY_Active,(ed->ed_PrefsWork.pg_GraphicFlags & PGFF_INTEGER_SCALING) >> 1,
				    TAG_DONE);

    SetGadgetAttr(ed,ed->ed_Image,GTCY_Active,ed->ed_PrefsWork.pg_Image,
				  TAG_DONE);

    SetGadgetAttr(ed,ed->ed_Aspect,GTCY_Active,ed->ed_PrefsWork.pg_Aspect,
				   TAG_DONE);

    SetGadgetAttr(ed,ed->ed_Shade,GTCY_Active,ed->ed_PrefsWork.pg_Shade,
				  TAG_DONE);

    SetGadgetAttr(ed,ed->ed_Density,GTSL_Level,ed->ed_PrefsWork.pg_PrintDensity,
                                    TAG_DONE);

    SetGadgetAttr(ed,ed->ed_Smoothing,GTCB_Checked, ed->ed_PrefsWork.pg_GraphicFlags & PGFF_ANTI_ALIAS,
                                      GA_Disabled,  ed->ed_PrefsWork.pg_Dithering == PD_FLOYD,
                                      TAG_DONE);

    SetGadgetAttr(ed,ed->ed_CenterPicture,GTCB_Checked,ed->ed_PrefsWork.pg_GraphicFlags & PGFF_CENTER_IMAGE,
                                          TAG_DONE);

    SetGadgetAttr(ed,ed->ed_LeftOffset,GTIN_Number, GetMM(ed,ed->ed_PrefsWork.pg_PrintXOffset),
                                       GA_Disabled, ed->ed_PrefsWork.pg_GraphicFlags & PGFF_CENTER_IMAGE,
                                       TAG_DONE);
d543 10
a552 2
    SetGadgetAttr(ed,ed->ed_Type,GTCY_Active,ed->ed_PrefsWork.pg_Dimensions,
			         TAG_DONE);
d558 5
a562 3
    SetGadgetAttr(ed,ed->ed_Width,GTIN_Number, num,
                                  GA_Disabled, ed->ed_PrefsWork.pg_Dimensions == PD_IGNORE,
                                  TAG_DONE);
d568 5
a572 3
    SetGadgetAttr(ed,ed->ed_Height,GTIN_Number, num,
                                   GA_Disabled, ed->ed_PrefsWork.pg_Dimensions == PD_IGNORE,
                                   TAG_DONE);
@


38.4
log
@Changes for new prefs shell
Less flickering when clicking on gadgets
@
text
@a239 21
    if (!(ed->ed_Window = OpenPrefsWindow(ed,WA_Left,        NW_LEFT,
                                             WA_Top,         NW_TOP,
                                             WA_InnerWidth,  NW_WIDTH,
                                             WA_InnerHeight, NW_HEIGHT,
                                             WA_MinWidth,    NW_MINWIDTH,
                                             WA_MinHeight,   NW_MINHEIGHT,
                                             WA_MaxWidth,    NW_MAXWIDTH,
                                             WA_MaxHeight,   NW_MAXHEIGHT,
                                             WA_IDCMP,       NW_IDCMP,
                                             WA_Flags,       NW_FLAGS,
                                             WA_Zoom,        zoomSize,
                                             WA_AutoAdjust,  TRUE,
                                             WA_PubScreen,   ed->ed_Screen,
                                             WA_Title,       GetString(&ed->ed_LocaleInfo,MSG_PGFX_NAME),
                                             WA_NewLookMenus,TRUE,
                                             TAG_DONE)))
    {
        FreeMenus(ed->ed_Menus);
	return(FALSE);
    }

d333 22
d364 5
a368 2
    ClearMenuStrip(ed->ed_Window);
    CloseWindow(ed->ed_Window);
@


38.3
log
@Changes for new pe_strings.c prefs shell module
@
text
@d124 1
a124 1
    if (ReadChunkBytes(iff,ed->ed_PrefsIO,sizeof(struct PrinterGfxPrefs)) == sizeof(struct PrinterGfxPrefs))
d131 1
a131 1
EdStatus OpenPrefs(EdDataPtr ed, STRPTR name, APTR destPrefs)
a132 1
    ed->ed_PrefsIO = destPrefs;
d143 1
a143 1
        if (WriteChunkBytes(iff,ed->ed_PrefsIO,sizeof(struct PrinterGfxPrefs)) == sizeof(struct PrinterGfxPrefs))
d151 1
a151 1
EdStatus SavePrefs(EdDataPtr ed, STRPTR name, APTR sourPrefs)
a152 1
    ed->ed_PrefsIO = sourPrefs;
d227 2
a228 1
UWORD zoomSize[4];
d261 19
a279 18
    ed->ed_DitheringLabels[0] = GetString(&ed->ed_LocaleInfo,MSG_PGFX_ORDERED);
    ed->ed_DitheringLabels[1] = GetString(&ed->ed_LocaleInfo,MSG_PGFX_HALFTONE);
    ed->ed_DitheringLabels[2] = GetString(&ed->ed_LocaleInfo,MSG_PGFX_FLOYDSTEINBERG);
    ed->ed_ScalingLabels[0]   = GetString(&ed->ed_LocaleInfo,MSG_PGFX_FRACTION);
    ed->ed_ScalingLabels[1]   = GetString(&ed->ed_LocaleInfo,MSG_PGFX_INTEGER);
    ed->ed_ImageLabels[0]     = GetString(&ed->ed_LocaleInfo,MSG_PGFX_POSITIVE);
    ed->ed_ImageLabels[1]     = GetString(&ed->ed_LocaleInfo,MSG_PGFX_NEGATIVE);
    ed->ed_AspectLabels[0]    = GetString(&ed->ed_LocaleInfo,MSG_PGFX_HORIZONTAL);
    ed->ed_AspectLabels[1]    = GetString(&ed->ed_LocaleInfo,MSG_PGFX_VERTICAL);
    ed->ed_ShadeLabels[0]     = GetString(&ed->ed_LocaleInfo,MSG_PGFX_BLACK_AND_WHITE);
    ed->ed_ShadeLabels[1]     = GetString(&ed->ed_LocaleInfo,MSG_PGFX_GREY_SCALE_1);
    ed->ed_ShadeLabels[2]     = GetString(&ed->ed_LocaleInfo,MSG_PGFX_COLOR);
    ed->ed_ShadeLabels[3]     = GetString(&ed->ed_LocaleInfo,MSG_PGFX_GREY_SCALE_2);
    ed->ed_TypeLabels[0]      = GetString(&ed->ed_LocaleInfo,MSG_PGFX_IGNORE);
    ed->ed_TypeLabels[1]      = GetString(&ed->ed_LocaleInfo,MSG_PGFX_BOUNDED);
    ed->ed_TypeLabels[2]      = GetString(&ed->ed_LocaleInfo,MSG_PGFX_ABSOLUTE);
    ed->ed_TypeLabels[3]      = GetString(&ed->ed_LocaleInfo,MSG_PGFX_PIXELS);
    ed->ed_TypeLabels[4]      = GetString(&ed->ed_LocaleInfo,MSG_PGFX_MULTIPLY);
d291 2
a292 2
    ed->ed_Dithering = CreatePrefsGadget(ed,&EG[7],GTCY_Labels,ed->ed_DitheringLabels,
						   GTCY_Active,ed->ed_PrefsWork.pg_Dithering,
d295 2
a296 2
    ed->ed_Scaling   = CreatePrefsGadget(ed,&EG[8],GTCY_Labels,ed->ed_ScalingLabels,
						   GTCY_Active,(ed->ed_PrefsWork.pg_GraphicFlags & PGFF_INTEGER_SCALING) >> 1,
d299 2
a300 2
    ed->ed_Image     = CreatePrefsGadget(ed,&EG[9],GTCY_Labels,ed->ed_ImageLabels,
						   GTCY_Active,ed->ed_PrefsWork.pg_Image,
d303 2
a304 2
    ed->ed_Aspect    = CreatePrefsGadget(ed,&EG[10],GTCY_Labels,ed->ed_AspectLabels,
						    GTCY_Active,ed->ed_PrefsWork.pg_Aspect,
d307 2
a308 2
    ed->ed_Shade     = CreatePrefsGadget(ed,&EG[11],GTCY_Labels,ed->ed_ShadeLabels,
						    GTCY_Active,ed->ed_PrefsWork.pg_Shade,
d311 7
a317 7
    ed->ed_Threshold = CreatePrefsGadget(ed,&EG[12],GTSL_Level,ed->ed_PrefsWork.pg_Threshold,
                                                    GTSL_MaxLevelLen,2,
                                                    GTSL_LevelFormat,"%2lu",
                                                    GA_RelVerify,TRUE,
                                                    GA_Immediate,TRUE,
    						    GTSL_Min,1,
    						    GTSL_Max,15,
d320 7
a326 7
    ed->ed_Density   = CreatePrefsGadget(ed,&EG[13],GTSL_Level,ed->ed_PrefsWork.pg_PrintDensity,
                                                    GTSL_MaxLevelLen,2,
                                                    GTSL_LevelFormat,"%2lu",
                                                    GA_RelVerify,TRUE,
                                                    GA_Immediate,TRUE,
    						    GTSL_Min,1,
    						    GTSL_Max,7,
d336 2
a337 2
    ed->ed_Type          = CreatePrefsGadget(ed,&EG[17],GTCY_Labels,ed->ed_TypeLabels,
                                                        GTCY_Active,ed->ed_PrefsWork.pg_Dimensions,
d350 1
a350 3
        CloseWindow(ed->ed_Window);
        FreeMenus(ed->ed_Menus);
        FreeGadgets(ed->ed_Gadgets);
a353 6
    SetFont(ed->ed_Window->RPort,ed->ed_Font);
    SetMenuStrip(ed->ed_Window,ed->ed_Menus);
    AddGList(ed->ed_Window,ed->ed_Gadgets,-1,-1,NULL);
    RefreshGList(ed->ed_Gadgets,ed->ed_Window,NULL,-1);
    GT_RefreshWindow(ed->ed_Window,NULL);

d418 23
a442 2
STRPTR            str;
UWORD             len;
d454 1
a454 6
    str  = GetString(&ed->ed_LocaleInfo,left);
    len  = strlen(str);

    Move(rp,494 - TextLength(rp,str,len) + window->BorderLeft - 8,
            window->BorderTop+74);
    Text(rp,str,len);
d468 2
a469 13
    str  = GetString(&ed->ed_LocaleInfo,width);
    len  = strlen(str);

    Move(rp,494 - TextLength(rp,str,len) + window->BorderLeft - 8,
            window->BorderTop+124);
    Text(rp,str,len);

    str  = GetString(&ed->ed_LocaleInfo,width+1);
    len  = strlen(str);

    Move(rp,494 - TextLength(rp,str,len) + window->BorderLeft - 8,
            window->BorderTop+140);
    Text(rp,str,len);
a477 2
STRPTR           str;
UWORD            len;
d484 1
a484 6
    str  = GetString(&ed->ed_LocaleInfo,MSG_PGFX_COLORCORRECT_HDR);
    len  = strlen(str);

    Move(rp,(245 - TextLength(rp,str,len)) / 2 + window->BorderLeft + 307,
            window->BorderTop+10);
    Text(rp,str,len);
d490 1
a490 6
    str  = GetString(&ed->ed_LocaleInfo,MSG_PGFX_LIMITS_HDR);
    len  = strlen(str);

    Move(rp,(245 - TextLength(rp,str,len)) / 2 + window->BorderLeft + 307,
            window->BorderTop+94);
    Text(rp,str,len);
d499 2
a500 1
VOID RenderGadgets(EdDataPtr ed)
d502 2
a503 4
ULONG num;

    SetGadgetAttr(ed,ed->ed_Red,GTCB_Checked,ed->ed_PrefsWork.pg_ColorCorrect & PCCF_RED,
                                GA_Disabled,ed->ed_PrefsWork.pg_Shade != PS_COLOR,
d506 2
a507 2
    SetGadgetAttr(ed,ed->ed_Green,GTCB_Checked,ed->ed_PrefsWork.pg_ColorCorrect & PCCF_GREEN,
    				  GA_Disabled,ed->ed_PrefsWork.pg_Shade != PS_COLOR,
d510 2
a511 2
    SetGadgetAttr(ed,ed->ed_Blue,GTCB_Checked,ed->ed_PrefsWork.pg_ColorCorrect & PCCF_BLUE,
    				 GA_Disabled,ed->ed_PrefsWork.pg_Shade != PS_COLOR,
d514 15
a546 4
    SetGadgetAttr(ed,ed->ed_Threshold,GTSL_Level,ed->ed_PrefsWork.pg_Threshold,
    				      GA_Disabled, ed->ed_PrefsWork.pg_Shade != PS_BW,
                                      TAG_DONE);

d550 2
a551 2
    SetGadgetAttr(ed,ed->ed_Smoothing,GTCB_Checked,ed->ed_PrefsWork.pg_GraphicFlags & PGFF_ANTI_ALIAS,
                                      GA_Disabled,ed->ed_PrefsWork.pg_Dithering == PD_FLOYD,
d557 2
a558 2
    SetGadgetAttr(ed,ed->ed_LeftOffset,GTIN_Number,GetMM(ed,ed->ed_PrefsWork.pg_PrintXOffset),
                                       GA_Disabled,ed->ed_PrefsWork.pg_GraphicFlags & PGFF_CENTER_IMAGE,
d568 2
a569 2
    SetGadgetAttr(ed,ed->ed_Width,GTIN_Number,num,
                                  GA_Disabled,ed->ed_PrefsWork.pg_Dimensions == PD_IGNORE,
d576 2
a577 2
    SetGadgetAttr(ed,ed->ed_Height,GTIN_Number,num,
                                   GA_Disabled,ed->ed_PrefsWork.pg_Dimensions == PD_IGNORE,
a587 1
BOOL             refresh;
d591 1
d593 1
a593 1
    if (ed->ed_CurrentMsg->Class == IDCMP_MOUSEMOVE)
d596 2
a597 2
    icode   = ed->ed_CurrentMsg->Code;
    refresh = FALSE;
d599 1
a599 1
    shift   = (IEQUALIFIER_LSHIFT|IEQUALIFIER_RSHIFT) & ed->ed_CurrentMsg->Qualifier;
d603 2
a604 3
	case EC_RED            : if (ed->ed_PrefsWork.pg_ColorCorrect & PCCF_RED)
                                     ed->ed_PrefsWork.pg_ColorCorrect &= ~(PCCF_RED);
                                 else
d611 2
a612 3
	case EC_GREEN          :  if (ed->ed_PrefsWork.pg_ColorCorrect & PCCF_GREEN)
                                     ed->ed_PrefsWork.pg_ColorCorrect &= ~(PCCF_GREEN);
                                 else
d619 2
a620 3
	case EC_BLUE           : if (ed->ed_PrefsWork.pg_ColorCorrect & PCCF_BLUE)
                                     ed->ed_PrefsWork.pg_ColorCorrect &= ~(PCCF_BLUE);
                                 else
d649 1
a649 1
                                 refresh = TRUE;
d658 2
a659 3
        case EC_SMOOTHING      : if (ed->ed_PrefsWork.pg_GraphicFlags & PGFF_ANTI_ALIAS)
                                     ed->ed_PrefsWork.pg_GraphicFlags &= ~(PGFF_ANTI_ALIAS);
                                 else
d663 2
a664 3
        case EC_CENTERPICTURE  : if (ed->ed_PrefsWork.pg_GraphicFlags & PGFF_CENTER_IMAGE)
                                     ed->ed_PrefsWork.pg_GraphicFlags &= ~(PGFF_CENTER_IMAGE);
                                 else
d775 1
a775 20
        case EC_METRIC         :
/*
                                 current = ed->ed_Metric;
                                 ed->ed_Metric = TRUE;

                                 if (current)
                                 {
                                     ed->ed_PrefsWork.pg_PrintXOffset   = GetTenths(ed,ed->ed_PrefsWork.pg_PrintXOffset);
                                     ed->ed_PrefsWork.pg_PrintMaxWidth  = GetTenths(ed,ed->ed_PrefsWork.pg_PrintMaxWidth);
                                     ed->ed_PrefsWork.pg_PrintMaxHeight = GetTenths(ed,ed->ed_PrefsWork.pg_PrintMaxHeight);
                                 }
                                 else
                                 {
                                     ed->ed_PrefsWork.pg_PrintXOffset   = GetMM(ed,ed->ed_PrefsWork.pg_PrintXOffset);
                                     ed->ed_PrefsWork.pg_PrintMaxWidth  = GetMM(ed,ed->ed_PrefsWork.pg_PrintMaxWidth);
                                     ed->ed_PrefsWork.pg_PrintMaxHeight = GetMM(ed,ed->ed_PrefsWork.pg_PrintMaxHeight);
                                 }
*/

				 ed->ed_Metric = !ed->ed_Metric;
d777 1
a777 1
        			 refresh = TRUE;
a782 3
    if (refresh)
        RenderGadgets(ed);

a803 3

    if (ec == EC_SAVEICONS)
        state->cs_Selected = ed->ed_SaveIcons;
@


38.2
log
@Changes for new prefs shell
@
text
@d45 1
a45 1
#include "texttable.h"
d188 1
a188 1
      {NM_ITEM, MSG_OPTIONS_METRIC,         EC_METRIC,    CHECKIT|MENUTOGGLE},
d199 4
a202 4
    {CHECKBOX_KIND, 425, 18,   87,  14, MSG_RED_GAD,           EC_RED,     0},
    {CHECKBOX_KIND, 425, 30,   87,  14, MSG_GREEN_GAD,         EC_GREEN,   0},
    {CHECKBOX_KIND, 425, 42,   87,  14, MSG_BLUE_GAD,          EC_BLUE,    0},
    {NUMBER_KIND,   490, 33,   36,  13, MSG_COLORS_GAD,        EC_NOP,     PLACETEXT_ABOVE},
d204 8
a211 8
    {CYCLE_KIND,    127, 8,    176, 14, MSG_DITHERING_GAD,     EC_DITHERING, 0},
    {CYCLE_KIND,    127, 22,   176, 14, MSG_SCALING_GAD,       EC_SCALING,   0},
    {CYCLE_KIND,    127, 36,   176, 14, MSG_IMAGE_GAD,         EC_IMAGE,     0},
    {CYCLE_KIND,    127, 50,   176, 14, MSG_ASPECT_GAD,        EC_ASPECT,    0},
    {CYCLE_KIND,    127, 64,   176, 14, MSG_SHADE_GAD,         EC_SHADE,     0},

    {SLIDER_KIND,   143, 84,   160, 11, MSG_THRESHOLD_GAD,     EC_THRESHOLD, 0},
    {SLIDER_KIND,   143, 97,   160, 11, MSG_DENSITY_GAD,       EC_DENSITY,   0},
d213 2
a214 2
    {CHECKBOX_KIND, 127, 117,  87,  14, MSG_SMOOTHING_GAD,     EC_SMOOTHING,     PLACETEXT_RIGHT},
    {CHECKBOX_KIND, 127, 131,  87,  14, MSG_CENTERPICTURE_GAD, EC_CENTERPICTURE, PLACETEXT_RIGHT},
d218 1
a218 1
    {CYCLE_KIND,    412, 99,   136, 14, MSG_TYPE_GAD,          EC_TYPE,     0},
d254 1
a254 1
                                             WA_Title,       EDITOR_NAME,
d262 18
a279 18
    ed->ed_DitheringLabels[0] = GetString(&ed->ed_LocaleInfo,MSG_ORDERED);
    ed->ed_DitheringLabels[1] = GetString(&ed->ed_LocaleInfo,MSG_HALFTONE);
    ed->ed_DitheringLabels[2] = GetString(&ed->ed_LocaleInfo,MSG_FLOYDSTEINBERG);
    ed->ed_ScalingLabels[0]   = GetString(&ed->ed_LocaleInfo,MSG_FRACTION);
    ed->ed_ScalingLabels[1]   = GetString(&ed->ed_LocaleInfo,MSG_INTEGER);
    ed->ed_ImageLabels[0]     = GetString(&ed->ed_LocaleInfo,MSG_POSITIVE);
    ed->ed_ImageLabels[1]     = GetString(&ed->ed_LocaleInfo,MSG_NEGATIVE);
    ed->ed_AspectLabels[0]    = GetString(&ed->ed_LocaleInfo,MSG_HORIZONTAL);
    ed->ed_AspectLabels[1]    = GetString(&ed->ed_LocaleInfo,MSG_VERTICAL);
    ed->ed_ShadeLabels[0]     = GetString(&ed->ed_LocaleInfo,MSG_BLACK_AND_WHITE);
    ed->ed_ShadeLabels[1]     = GetString(&ed->ed_LocaleInfo,MSG_GREY_SCALE_1);
    ed->ed_ShadeLabels[2]     = GetString(&ed->ed_LocaleInfo,MSG_COLOR);
    ed->ed_ShadeLabels[3]     = GetString(&ed->ed_LocaleInfo,MSG_GREY_SCALE_2);
    ed->ed_TypeLabels[0]      = GetString(&ed->ed_LocaleInfo,MSG_IGNORE);
    ed->ed_TypeLabels[1]      = GetString(&ed->ed_LocaleInfo,MSG_BOUNDED);
    ed->ed_TypeLabels[2]      = GetString(&ed->ed_LocaleInfo,MSG_ABSOLUTE);
    ed->ed_TypeLabels[3]      = GetString(&ed->ed_LocaleInfo,MSG_PIXELS);
    ed->ed_TypeLabels[4]      = GetString(&ed->ed_LocaleInfo,MSG_MULTIPLY);
d430 2
a431 2
enum AppStringsID width,left;
struct RastPort *rp;
d437 1
a437 1
    left = MSG_LEFTOFFSET0_GAD;
d439 1
a439 1
        left = MSG_LEFTOFFSET1_GAD;
d451 1
a451 1
            width = MSG_WIDTH1_GAD;
d453 1
a453 1
            width = MSG_WIDTH2_GAD;
d457 1
a457 1
        width = MSG_WIDTH0_GAD+(ed->ed_PrefsWork.pg_Dimensions*2);
d489 1
a489 1
    str  = GetString(&ed->ed_LocaleInfo,MSG_COLORCORRECT_HDR);
d500 1
a500 1
    str  = GetString(&ed->ed_LocaleInfo,MSG_LIMITS_HDR);
@


38.1
log
@Initial V38 RCS checkin
@
text
@d63 4
@
