MC68000 ASSEMBLER VERSION 11.183                                                                                                   

   LOC              OBJECT             STMT            SOURCE STATEMENT


0000'                                     1         SECTION mathieeedoubbas
          =00000001                       2 NEWNULCA        equ 1
                                          8         INCLUDE "nulca.i"
                                          1
                                          2 NULCA1  macro
                                          3 \@restart       move.w  \1,command(a0)
                                          4 \@comeagain     move.w  (a0),d7
                                          5                 btst    #12,d7
                                          6                 beq.s   \@morework
                                          7 ;               bit 12=1
                                          8                 btst    #11,d7
                                          9                 beq.s   \@exit_and_eval
                                         10 \@morework
                                         11                 tst.w   d7
                                         12                 bmi     \@maybedone
                                         13                 cmp.w   #$4900,d7
                                         14                 beq     \@comeagain
                                         15                 cmp.w   #$900,d7
                                         16                 ble     \@comeagain
                                         17                 bsr     exception
                                         18                 bra     \@restart
                                         19 \@maybedone
                                         20                 cmp.w   #$8900,d7
                                         21                 beq.s   \@comeagain
                                         22                 cmp.w   #$C900,d7
                                         23                 beq.s   \@comeagain
                                         24 \@exit_and_eval:
                                         25         endm
                                         26
                                         27 ;NULCA1 macro
                                         28 ;\@restart      move.w  \1,command(a0)
                                         29 ;\@w78  move.w  (a0),d7
                                         30 ;       cmp.w   #$8900,d7
                                         31 ;       beq     \@w78
                                         32 ;;      check for pending exceptions
                                         33 ;       tst.w   d7      ; can use a different bcc later
                                         34 ;;              do a gross check inline
                                         35 ;       bmi.s   \@w79
                                         36 ;               bsr     exception
                                         37 ;;              test code
                                         38 ;               bra     \@restart
                                         39 ;
                                         40 ;\@w79:
                                         41 ;       cmp.w   #$C900,d7
                                         42 ;       beq     \@w78
                                         43 ;       endm
                                         44
                                         45 *       NULL Release Macro
                                         46 NULREL  macro
                                         47 \@nr    tst.w   (a0)
                                         48         bmi     \@nr
                                         49         endm
                                          9 SETUP   macro
                                         10         move.l  d7,-(sp)                ; used for exception processing
                                         11         move.l  MathIEEEBase_68881(a6),a0       ; points to base of 68881 regs
MC68000 ASSEMBLER VERSION 11.183                                                                                                   

   LOC              OBJECT             STMT            SOURCE STATEMENT


                                         12         lea     operand(a0),a1          ; preload a1
                                         13         endm
                                         14 SHUTDOWN        macro
                                         15         move.l  (sp)+,d7
                                         16         rts
                                         17         endm
                                         18 SHUTDOWNCC      macro
                                         19         tst.l   d0      ; get proper condition codes
                                         20         rts
                                         21         endm
          =0000                          22 resp    equ     0
          =00000002                      23 control equ     2
          =00000004                      24 save    equ     4
          =00000006                      25 restore equ     6
          =00000008                      26 opword  equ     8
          =0000000A                      27 command equ     10
          =0000000E                      28 cond    equ     14
          =00000010                      29 operand equ     16
          =0000                          30 fp0     equ     $0000
          =00000080                      31 fp1     equ     $0080
          =00001000                      32 fpcr    equ     $1000
          =00000800                      33 fpsr    equ     $0800
          =00000400                      34 fpiar   equ     $0400
          =00005400                      35 fmvtofp equ     $5400           ;move to fp reg (double)
          =00007400                      36 fmvfrfp equ     $7400           ;move from fp reg (double)
          =00006000                      37 fptlong equ     $6000           ;move from fp reg (long)
          =00004000                      38 fgtlong equ     $4000           ;move to fp reg (long)
          =00005422                      39 fadd2fp equ     $5422           ;add to fp reg (double)
          =00005428                      40 fsub2fp equ     $5428           ;sub to fp reg (double)
          =00005423                      41 fmul2fp equ     $5423           ;mul to fp reg (double)
          =00005420                      42 fdiv2fp equ     $5420           ;div to fp reg (double)
          =00000001                      43 fint    equ     $0001           ;round to whatever
          =00000003                      44 fintrz  equ     $0003           ;round to zero
          =0000541A                      45 fneg2fp equ     $541a           ;negate to fp reg (double)
          =00005418                      46 fabs2fp equ     $5418           ;abs to fp reg (double)
          =00005438                      47 fcmp2fp equ     $5438           ;cmp to fp reg (double)
          =00004026                      48 fsclong equ     $4026           ;scale to fp reg (long)
          =0000                          49 fgtext  equ     $0000           ;move to fp reg (extended)
          =00000428                      50 fsubext equ     $0428           ;sub fp1 from fp0 (extended)
          =00008000                      51 fmvtocr equ     $8000           ;move to fp contrl register (long)
          =0000A000                      52 fmvfrcr equ     $a000           ;move to fp contrl register (long)
0000'                                    53 do_exception:
0000'                                    54 exception:
0000'      317C  0002  0002              55         move.w  #$2,control(a0)
0006'      0247  00FF                    56         and.w   #$ff,d7 ; extract vector number
                                         57 *>      if      #50=d7.w
000A'      0C47  0032                    58         cmp.w #50,d7
000E'      6604                          59         bne.s _if00000
0010'      8EFC  0000                    60                 divu    #0,d7   ; force the issue
                                         61 *>      endif
0014'                                    62 _if00000:
                                         63 *>      if      #53=d7.w
0014'      0C47  0035                    64         cmp.w #53,d7
0018'      6606                          65         bne.s _if00001
001A'      003C  0002                    66                 ori     #2,ccr
MC68000 ASSEMBLER VERSION 11.183                                                                                                   

   LOC              OBJECT             STMT            SOURCE STATEMENT


001E'      4E76                          67                 trapv           ; force it
                                         68 *>      endif
0020'                                    69 _if00001:
0020'      4E75                          70         rts
                                         71         xdef    IOMIIEEEDPFlt
                                         72         xdef    IOMIIEEEDPAdd
                                         73         xdef    IOMIIEEEDPSub
                                         74         xdef    IOMIIEEEDPMul
                                         75         xdef    IOMIIEEEDPDiv
                                         76         xdef    IOMIIEEEDPFloor
0022'                                    77 IOMIIEEEDPFlt
                                         78         SETUP
0022'      2F07                          78+        move.l  d7,-(sp)                ; used for exception processing
0024'      206E  0024                    78+        move.l  MathIEEEBase_68881(a6),a0       ; points to base of 68881 regs
0028'      43E8  0010                    78+        lea     operand(a0),a1          ; preload a1
                                         79         NULCA1  #fgtlong+fp0
002C'      317C  4000  000A              79+.006restart     move.w  #fgtlong+fp0,command(a0)
0032'      3E10                          79+.006comeagain   move.w  (a0),d7
0034'      0807  000C                    79+                btst    #12,d7
0038'      6706                          79+                beq.s   .006morework
                                         79+;               bit 12=1
003A'      0807  000B                    79+                btst    #11,d7
003E'      6722                          79+                beq.s   .006exit_and_eval
0040'                                    79+.006morework
0040'      4A47                          79+                tst.w   d7
0042'      6B00  0012                    79+                bmi     .006maybedone
0046'      0C47  4900                    79+                cmp.w   #$4900,d7
004A'      67E6                          79+                beq     .006comeagain
004C'      0C47  0900                    79+                cmp.w   #$900,d7
0050'      6FE0                          79+                ble     .006comeagain
0052'      61AC                          79+                bsr     exception
0054'      60D6                          79+                bra     .006restart
0056'                                    79+.006maybedone
0056'      0C47  8900                    79+                cmp.w   #$8900,d7
005A'      67D6                          79+                beq.s   .006comeagain
005C'      0C47  C900                    79+                cmp.w   #$C900,d7
0060'      67D0                          79+                beq.s   .006comeagain
0062'                                    79+.006exit_and_eval:
0062'      2280                          80         move.l  d0,(a1)
                                         81         NULREL
0064'      4A50                          81+.007nr  tst.w   (a0)
0066'      6BFC                          81+        bmi     .007nr
                                         82         NULCA1  #fmvfrfp+fp0
0068'      317C  7400  000A              82+.008restart     move.w  #fmvfrfp+fp0,command(a0)
006E'      3E10                          82+.008comeagain   move.w  (a0),d7
0070'      0807  000C                    82+                btst    #12,d7
0074'      6706                          82+                beq.s   .008morework
                                         82+;               bit 12=1
0076'      0807  000B                    82+                btst    #11,d7
007A'      6724                          82+                beq.s   .008exit_and_eval
007C'                                    82+.008morework
007C'      4A47                          82+                tst.w   d7
007E'      6B00  0014                    82+                bmi     .008maybedone
0082'      0C47  4900                    82+                cmp.w   #$4900,d7
0086'      67E6                          82+                beq     .008comeagain
MC68000 ASSEMBLER VERSION 11.183                                                                                                   

   LOC              OBJECT             STMT            SOURCE STATEMENT


0088'      0C47  0900                    82+                cmp.w   #$900,d7
008C'      6FE0                          82+                ble     .008comeagain
008E'      6100  FF70                    82+                bsr     exception
0092'      60D4                          82+                bra     .008restart
0094'                                    82+.008maybedone
0094'      0C47  8900                    82+                cmp.w   #$8900,d7
0098'      67D4                          82+                beq.s   .008comeagain
009A'      0C47  C900                    82+                cmp.w   #$C900,d7
009E'      67CE                          82+                beq.s   .008comeagain
00A0'                                    82+.008exit_and_eval:
00A0'      2011                          83         move.l  (a1),d0
00A2'      2211                          84         move.l  (a1),d1
                                         85         NULREL
00A4'      4A50                          85+.009nr  tst.w   (a0)
00A6'      6BFC                          85+        bmi     .009nr
                                         86         SHUTDOWN
00A8'      2E1F                          86+        move.l  (sp)+,d7
00AA'      4E75                          86+        rts
00AC'                                    87 IOMIIEEEDPAdd
                                         88         SETUP
00AC'      2F07                          88+        move.l  d7,-(sp)                ; used for exception processing
00AE'      206E  0024                    88+        move.l  MathIEEEBase_68881(a6),a0       ; points to base of 68881 regs
00B2'      43E8  0010                    88+        lea     operand(a0),a1          ; preload a1
                                         89         NULCA1  #fmvtofp+fp0
00B6'      317C  5400  000A              89+.010restart     move.w  #fmvtofp+fp0,command(a0)
00BC'      3E10                          89+.010comeagain   move.w  (a0),d7
00BE'      0807  000C                    89+                btst    #12,d7
00C2'      6706                          89+                beq.s   .010morework
                                         89+;               bit 12=1
00C4'      0807  000B                    89+                btst    #11,d7
00C8'      6724                          89+                beq.s   .010exit_and_eval
00CA'                                    89+.010morework
00CA'      4A47                          89+                tst.w   d7
00CC'      6B00  0014                    89+                bmi     .010maybedone
00D0'      0C47  4900                    89+                cmp.w   #$4900,d7
00D4'      67E6                          89+                beq     .010comeagain
00D6'      0C47  0900                    89+                cmp.w   #$900,d7
00DA'      6FE0                          89+                ble     .010comeagain
00DC'      6100  FF22                    89+                bsr     exception
00E0'      60D4                          89+                bra     .010restart
00E2'                                    89+.010maybedone
00E2'      0C47  8900                    89+                cmp.w   #$8900,d7
00E6'      67D4                          89+                beq.s   .010comeagain
00E8'      0C47  C900                    89+                cmp.w   #$C900,d7
00EC'      67CE                          89+                beq.s   .010comeagain
00EE'                                    89+.010exit_and_eval:
00EE'      2280                          90         move.l  d0,(a1)
00F0'      2281                          91         move.l  d1,(a1)
                                         92         NULREL
00F2'      4A50                          92+.011nr  tst.w   (a0)
00F4'      6BFC                          92+        bmi     .011nr
                                         93         NULCA1  #fadd2fp+fp0
00F6'      317C  5422  000A              93+.012restart     move.w  #fadd2fp+fp0,command(a0)
00FC'      3E10                          93+.012comeagain   move.w  (a0),d7
00FE'      0807  000C                    93+                btst    #12,d7
MC68000 ASSEMBLER VERSION 11.183                                                                                                   

   LOC              OBJECT             STMT            SOURCE STATEMENT


0102'      6706                          93+                beq.s   .012morework
                                         93+;               bit 12=1
0104'      0807  000B                    93+                btst    #11,d7
0108'      6724                          93+                beq.s   .012exit_and_eval
010A'                                    93+.012morework
010A'      4A47                          93+                tst.w   d7
010C'      6B00  0014                    93+                bmi     .012maybedone
0110'      0C47  4900                    93+                cmp.w   #$4900,d7
0114'      67E6                          93+                beq     .012comeagain
0116'      0C47  0900                    93+                cmp.w   #$900,d7
011A'      6FE0                          93+                ble     .012comeagain
011C'      6100  FEE2                    93+                bsr     exception
0120'      60D4                          93+                bra     .012restart
0122'                                    93+.012maybedone
0122'      0C47  8900                    93+                cmp.w   #$8900,d7
0126'      67D4                          93+                beq.s   .012comeagain
0128'      0C47  C900                    93+                cmp.w   #$C900,d7
012C'      67CE                          93+                beq.s   .012comeagain
012E'                                    93+.012exit_and_eval:
012E'      2282                          94         move.l  d2,(a1)
0130'      2283                          95         move.l  d3,(a1)
                                         96         NULREL
0132'      4A50                          96+.013nr  tst.w   (a0)
0134'      6BFC                          96+        bmi     .013nr
                                         97         NULCA1  #fmvfrfp+fp0
0136'      317C  7400  000A              97+.014restart     move.w  #fmvfrfp+fp0,command(a0)
013C'      3E10                          97+.014comeagain   move.w  (a0),d7
013E'      0807  000C                    97+                btst    #12,d7
0142'      6706                          97+                beq.s   .014morework
                                         97+;               bit 12=1
0144'      0807  000B                    97+                btst    #11,d7
0148'      6724                          97+                beq.s   .014exit_and_eval
014A'                                    97+.014morework
014A'      4A47                          97+                tst.w   d7
014C'      6B00  0014                    97+                bmi     .014maybedone
0150'      0C47  4900                    97+                cmp.w   #$4900,d7
0154'      67E6                          97+                beq     .014comeagain
0156'      0C47  0900                    97+                cmp.w   #$900,d7
015A'      6FE0                          97+                ble     .014comeagain
015C'      6100  FEA2                    97+                bsr     exception
0160'      60D4                          97+                bra     .014restart
0162'                                    97+.014maybedone
0162'      0C47  8900                    97+                cmp.w   #$8900,d7
0166'      67D4                          97+                beq.s   .014comeagain
0168'      0C47  C900                    97+                cmp.w   #$C900,d7
016C'      67CE                          97+                beq.s   .014comeagain
016E'                                    97+.014exit_and_eval:
016E'      2011                          98         move.l  (a1),d0
0170'      2211                          99         move.l  (a1),d1
                                        100         NULREL
0172'      4A50                         100+.015nr  tst.w   (a0)
0174'      6BFC                         100+        bmi     .015nr
                                        101         SHUTDOWN
0176'      2E1F                         101+        move.l  (sp)+,d7
0178'      4E75                         101+        rts
MC68000 ASSEMBLER VERSION 11.183                                                                                                   

   LOC              OBJECT             STMT            SOURCE STATEMENT


017A'                                   102 IOMIIEEEDPSub
                                        103         SETUP
017A'      2F07                         103+        move.l  d7,-(sp)                ; used for exception processing
017C'      206E  0024                   103+        move.l  MathIEEEBase_68881(a6),a0       ; points to base of 68881 regs
0180'      43E8  0010                   103+        lea     operand(a0),a1          ; preload a1
                                        104         NULCA1  #fmvtofp+fp0
0184'      317C  5400  000A             104+.016restart     move.w  #fmvtofp+fp0,command(a0)
018A'      3E10                         104+.016comeagain   move.w  (a0),d7
018C'      0807  000C                   104+                btst    #12,d7
0190'      6706                         104+                beq.s   .016morework
                                        104+;               bit 12=1
0192'      0807  000B                   104+                btst    #11,d7
0196'      6724                         104+                beq.s   .016exit_and_eval
0198'                                   104+.016morework
0198'      4A47                         104+                tst.w   d7
019A'      6B00  0014                   104+                bmi     .016maybedone
019E'      0C47  4900                   104+                cmp.w   #$4900,d7
01A2'      67E6                         104+                beq     .016comeagain
01A4'      0C47  0900                   104+                cmp.w   #$900,d7
01A8'      6FE0                         104+                ble     .016comeagain
01AA'      6100  FE54                   104+                bsr     exception
01AE'      60D4                         104+                bra     .016restart
01B0'                                   104+.016maybedone
01B0'      0C47  8900                   104+                cmp.w   #$8900,d7
01B4'      67D4                         104+                beq.s   .016comeagain
01B6'      0C47  C900                   104+                cmp.w   #$C900,d7
01BA'      67CE                         104+                beq.s   .016comeagain
01BC'                                   104+.016exit_and_eval:
01BC'      2280                         105         move.l  d0,(a1)
01BE'      2281                         106         move.l  d1,(a1)
                                        107         NULREL
01C0'      4A50                         107+.017nr  tst.w   (a0)
01C2'      6BFC                         107+        bmi     .017nr
                                        108         NULCA1  #fsub2fp+fp0
01C4'      317C  5428  000A             108+.018restart     move.w  #fsub2fp+fp0,command(a0)
01CA'      3E10                         108+.018comeagain   move.w  (a0),d7
01CC'      0807  000C                   108+                btst    #12,d7
01D0'      6706                         108+                beq.s   .018morework
                                        108+;               bit 12=1
01D2'      0807  000B                   108+                btst    #11,d7
01D6'      6724                         108+                beq.s   .018exit_and_eval
01D8'                                   108+.018morework
01D8'      4A47                         108+                tst.w   d7
01DA'      6B00  0014                   108+                bmi     .018maybedone
01DE'      0C47  4900                   108+                cmp.w   #$4900,d7
01E2'      67E6                         108+                beq     .018comeagain
01E4'      0C47  0900                   108+                cmp.w   #$900,d7
01E8'      6FE0                         108+                ble     .018comeagain
01EA'      6100  FE14                   108+                bsr     exception
01EE'      60D4                         108+                bra     .018restart
01F0'                                   108+.018maybedone
01F0'      0C47  8900                   108+                cmp.w   #$8900,d7
01F4'      67D4                         108+                beq.s   .018comeagain
01F6'      0C47  C900                   108+                cmp.w   #$C900,d7
01FA'      67CE                         108+                beq.s   .018comeagain
MC68000 ASSEMBLER VERSION 11.183                                                                                                   

   LOC              OBJECT             STMT            SOURCE STATEMENT


01FC'                                   108+.018exit_and_eval:
01FC'      2282                         109         move.l  d2,(a1)
01FE'      2283                         110         move.l  d3,(a1)
                                        111         NULREL
0200'      4A50                         111+.019nr  tst.w   (a0)
0202'      6BFC                         111+        bmi     .019nr
                                        112         NULCA1  #fmvfrfp+fp0
0204'      317C  7400  000A             112+.020restart     move.w  #fmvfrfp+fp0,command(a0)
020A'      3E10                         112+.020comeagain   move.w  (a0),d7
020C'      0807  000C                   112+                btst    #12,d7
0210'      6706                         112+                beq.s   .020morework
                                        112+;               bit 12=1
0212'      0807  000B                   112+                btst    #11,d7
0216'      6724                         112+                beq.s   .020exit_and_eval
0218'                                   112+.020morework
0218'      4A47                         112+                tst.w   d7
021A'      6B00  0014                   112+                bmi     .020maybedone
021E'      0C47  4900                   112+                cmp.w   #$4900,d7
0222'      67E6                         112+                beq     .020comeagain
0224'      0C47  0900                   112+                cmp.w   #$900,d7
0228'      6FE0                         112+                ble     .020comeagain
022A'      6100  FDD4                   112+                bsr     exception
022E'      60D4                         112+                bra     .020restart
0230'                                   112+.020maybedone
0230'      0C47  8900                   112+                cmp.w   #$8900,d7
0234'      67D4                         112+                beq.s   .020comeagain
0236'      0C47  C900                   112+                cmp.w   #$C900,d7
023A'      67CE                         112+                beq.s   .020comeagain
023C'                                   112+.020exit_and_eval:
023C'      2011                         113         move.l  (a1),d0
023E'      2211                         114         move.l  (a1),d1
                                        115         NULREL
0240'      4A50                         115+.021nr  tst.w   (a0)
0242'      6BFC                         115+        bmi     .021nr
                                        116         SHUTDOWN
0244'      2E1F                         116+        move.l  (sp)+,d7
0246'      4E75                         116+        rts
0248'                                   117 IOMIIEEEDPMul
                                        118         SETUP
0248'      2F07                         118+        move.l  d7,-(sp)                ; used for exception processing
024A'      206E  0024                   118+        move.l  MathIEEEBase_68881(a6),a0       ; points to base of 68881 regs
024E'      43E8  0010                   118+        lea     operand(a0),a1          ; preload a1
                                        119         NULCA1  #fmvtofp+fp0
0252'      317C  5400  000A             119+.022restart     move.w  #fmvtofp+fp0,command(a0)
0258'      3E10                         119+.022comeagain   move.w  (a0),d7
025A'      0807  000C                   119+                btst    #12,d7
025E'      6706                         119+                beq.s   .022morework
                                        119+;               bit 12=1
0260'      0807  000B                   119+                btst    #11,d7
0264'      6724                         119+                beq.s   .022exit_and_eval
0266'                                   119+.022morework
0266'      4A47                         119+                tst.w   d7
0268'      6B00  0014                   119+                bmi     .022maybedone
026C'      0C47  4900                   119+                cmp.w   #$4900,d7
0270'      67E6                         119+                beq     .022comeagain
MC68000 ASSEMBLER VERSION 11.183                                                                                                   

   LOC              OBJECT             STMT            SOURCE STATEMENT


0272'      0C47  0900                   119+                cmp.w   #$900,d7
0276'      6FE0                         119+                ble     .022comeagain
0278'      6100  FD86                   119+                bsr     exception
027C'      60D4                         119+                bra     .022restart
027E'                                   119+.022maybedone
027E'      0C47  8900                   119+                cmp.w   #$8900,d7
0282'      67D4                         119+                beq.s   .022comeagain
0284'      0C47  C900                   119+                cmp.w   #$C900,d7
0288'      67CE                         119+                beq.s   .022comeagain
028A'                                   119+.022exit_and_eval:
028A'      2280                         120         move.l  d0,(a1)
028C'      2281                         121         move.l  d1,(a1)
                                        122         NULREL
028E'      4A50                         122+.023nr  tst.w   (a0)
0290'      6BFC                         122+        bmi     .023nr
                                        123         NULCA1  #fmul2fp+fp0
0292'      317C  5423  000A             123+.024restart     move.w  #fmul2fp+fp0,command(a0)
0298'      3E10                         123+.024comeagain   move.w  (a0),d7
029A'      0807  000C                   123+                btst    #12,d7
029E'      6706                         123+                beq.s   .024morework
                                        123+;               bit 12=1
02A0'      0807  000B                   123+                btst    #11,d7
02A4'      6724                         123+                beq.s   .024exit_and_eval
02A6'                                   123+.024morework
02A6'      4A47                         123+                tst.w   d7
02A8'      6B00  0014                   123+                bmi     .024maybedone
02AC'      0C47  4900                   123+                cmp.w   #$4900,d7
02B0'      67E6                         123+                beq     .024comeagain
02B2'      0C47  0900                   123+                cmp.w   #$900,d7
02B6'      6FE0                         123+                ble     .024comeagain
02B8'      6100  FD46                   123+                bsr     exception
02BC'      60D4                         123+                bra     .024restart
02BE'                                   123+.024maybedone
02BE'      0C47  8900                   123+                cmp.w   #$8900,d7
02C2'      67D4                         123+                beq.s   .024comeagain
02C4'      0C47  C900                   123+                cmp.w   #$C900,d7
02C8'      67CE                         123+                beq.s   .024comeagain
02CA'                                   123+.024exit_and_eval:
02CA'      2282                         124         move.l  d2,(a1)
02CC'      2283                         125         move.l  d3,(a1)
                                        126         NULREL
02CE'      4A50                         126+.025nr  tst.w   (a0)
02D0'      6BFC                         126+        bmi     .025nr
                                        127         NULCA1  #fmvfrfp+fp0
02D2'      317C  7400  000A             127+.026restart     move.w  #fmvfrfp+fp0,command(a0)
02D8'      3E10                         127+.026comeagain   move.w  (a0),d7
02DA'      0807  000C                   127+                btst    #12,d7
02DE'      6706                         127+                beq.s   .026morework
                                        127+;               bit 12=1
02E0'      0807  000B                   127+                btst    #11,d7
02E4'      6724                         127+                beq.s   .026exit_and_eval
02E6'                                   127+.026morework
02E6'      4A47                         127+                tst.w   d7
02E8'      6B00  0014                   127+                bmi     .026maybedone
02EC'      0C47  4900                   127+                cmp.w   #$4900,d7
MC68000 ASSEMBLER VERSION 11.183                                                                                                   

   LOC              OBJECT             STMT            SOURCE STATEMENT


02F0'      67E6                         127+                beq     .026comeagain
02F2'      0C47  0900                   127+                cmp.w   #$900,d7
02F6'      6FE0                         127+                ble     .026comeagain
02F8'      6100  FD06                   127+                bsr     exception
02FC'      60D4                         127+                bra     .026restart
02FE'                                   127+.026maybedone
02FE'      0C47  8900                   127+                cmp.w   #$8900,d7
0302'      67D4                         127+                beq.s   .026comeagain
0304'      0C47  C900                   127+                cmp.w   #$C900,d7
0308'      67CE                         127+                beq.s   .026comeagain
030A'                                   127+.026exit_and_eval:
030A'      2011                         128         move.l  (a1),d0
030C'      2211                         129         move.l  (a1),d1
                                        130         NULREL
030E'      4A50                         130+.027nr  tst.w   (a0)
0310'      6BFC                         130+        bmi     .027nr
                                        131         SHUTDOWN
0312'      2E1F                         131+        move.l  (sp)+,d7
0314'      4E75                         131+        rts
0316'                                   132 IOMIIEEEDPDiv
                                        133         SETUP
0316'      2F07                         133+        move.l  d7,-(sp)                ; used for exception processing
0318'      206E  0024                   133+        move.l  MathIEEEBase_68881(a6),a0       ; points to base of 68881 regs
031C'      43E8  0010                   133+        lea     operand(a0),a1          ; preload a1
                                        134         NULCA1  #fmvtofp+fp0
0320'      317C  5400  000A             134+.028restart     move.w  #fmvtofp+fp0,command(a0)
0326'      3E10                         134+.028comeagain   move.w  (a0),d7
0328'      0807  000C                   134+                btst    #12,d7
032C'      6706                         134+                beq.s   .028morework
                                        134+;               bit 12=1
032E'      0807  000B                   134+                btst    #11,d7
0332'      6724                         134+                beq.s   .028exit_and_eval
0334'                                   134+.028morework
0334'      4A47                         134+                tst.w   d7
0336'      6B00  0014                   134+                bmi     .028maybedone
033A'      0C47  4900                   134+                cmp.w   #$4900,d7
033E'      67E6                         134+                beq     .028comeagain
0340'      0C47  0900                   134+                cmp.w   #$900,d7
0344'      6FE0                         134+                ble     .028comeagain
0346'      6100  FCB8                   134+                bsr     exception
034A'      60D4                         134+                bra     .028restart
034C'                                   134+.028maybedone
034C'      0C47  8900                   134+                cmp.w   #$8900,d7
0350'      67D4                         134+                beq.s   .028comeagain
0352'      0C47  C900                   134+                cmp.w   #$C900,d7
0356'      67CE                         134+                beq.s   .028comeagain
0358'                                   134+.028exit_and_eval:
0358'      2280                         135         move.l  d0,(a1)
035A'      2281                         136         move.l  d1,(a1)
                                        137         NULREL
035C'      4A50                         137+.029nr  tst.w   (a0)
035E'      6BFC                         137+        bmi     .029nr
                                        138         NULCA1  #fdiv2fp+fp0
0360'      317C  5420  000A             138+.030restart     move.w  #fdiv2fp+fp0,command(a0)
0366'      3E10                         138+.030comeagain   move.w  (a0),d7
MC68000 ASSEMBLER VERSION 11.183                                                                                                   

   LOC              OBJECT             STMT            SOURCE STATEMENT


0368'      0807  000C                   138+                btst    #12,d7
036C'      6706                         138+                beq.s   .030morework
                                        138+;               bit 12=1
036E'      0807  000B                   138+                btst    #11,d7
0372'      6724                         138+                beq.s   .030exit_and_eval
0374'                                   138+.030morework
0374'      4A47                         138+                tst.w   d7
0376'      6B00  0014                   138+                bmi     .030maybedone
037A'      0C47  4900                   138+                cmp.w   #$4900,d7
037E'      67E6                         138+                beq     .030comeagain
0380'      0C47  0900                   138+                cmp.w   #$900,d7
0384'      6FE0                         138+                ble     .030comeagain
0386'      6100  FC78                   138+                bsr     exception
038A'      60D4                         138+                bra     .030restart
038C'                                   138+.030maybedone
038C'      0C47  8900                   138+                cmp.w   #$8900,d7
0390'      67D4                         138+                beq.s   .030comeagain
0392'      0C47  C900                   138+                cmp.w   #$C900,d7
0396'      67CE                         138+                beq.s   .030comeagain
0398'                                   138+.030exit_and_eval:
0398'      2282                         139         move.l  d2,(a1)
039A'      2283                         140         move.l  d3,(a1)
                                        141         NULREL
039C'      4A50                         141+.031nr  tst.w   (a0)
039E'      6BFC                         141+        bmi     .031nr
                                        142         NULCA1  #fmvfrfp+fp0
03A0'      317C  7400  000A             142+.032restart     move.w  #fmvfrfp+fp0,command(a0)
03A6'      3E10                         142+.032comeagain   move.w  (a0),d7
03A8'      0807  000C                   142+                btst    #12,d7
03AC'      6706                         142+                beq.s   .032morework
                                        142+;               bit 12=1
03AE'      0807  000B                   142+                btst    #11,d7
03B2'      6724                         142+                beq.s   .032exit_and_eval
03B4'                                   142+.032morework
03B4'      4A47                         142+                tst.w   d7
03B6'      6B00  0014                   142+                bmi     .032maybedone
03BA'      0C47  4900                   142+                cmp.w   #$4900,d7
03BE'      67E6                         142+                beq     .032comeagain
03C0'      0C47  0900                   142+                cmp.w   #$900,d7
03C4'      6FE0                         142+                ble     .032comeagain
03C6'      6100  FC38                   142+                bsr     exception
03CA'      60D4                         142+                bra     .032restart
03CC'                                   142+.032maybedone
03CC'      0C47  8900                   142+                cmp.w   #$8900,d7
03D0'      67D4                         142+                beq.s   .032comeagain
03D2'      0C47  C900                   142+                cmp.w   #$C900,d7
03D6'      67CE                         142+                beq.s   .032comeagain
03D8'                                   142+.032exit_and_eval:
03D8'      2011                         143         move.l  (a1),d0
03DA'      2211                         144         move.l  (a1),d1
                                        145         NULREL
03DC'      4A50                         145+.033nr  tst.w   (a0)
03DE'      6BFC                         145+        bmi     .033nr
                                        146         SHUTDOWN
03E0'      2E1F                         146+        move.l  (sp)+,d7
MC68000 ASSEMBLER VERSION 11.183                                                                                                   

   LOC              OBJECT             STMT            SOURCE STATEMENT


03E2'      4E75                         146+        rts
03E4'                                   147 IOMIIEEEDPFloor
                                        148         SETUP
03E4'      2F07                         148+        move.l  d7,-(sp)                ; used for exception processing
03E6'      206E  0024                   148+        move.l  MathIEEEBase_68881(a6),a0       ; points to base of 68881 regs
03EA'      43E8  0010                   148+        lea     operand(a0),a1          ; preload a1
                                        149         NULCA1  #fmvtofp+fp0
03EE'      317C  5400  000A             149+.034restart     move.w  #fmvtofp+fp0,command(a0)
03F4'      3E10                         149+.034comeagain   move.w  (a0),d7
03F6'      0807  000C                   149+                btst    #12,d7
03FA'      6706                         149+                beq.s   .034morework
                                        149+;               bit 12=1
03FC'      0807  000B                   149+                btst    #11,d7
0400'      6724                         149+                beq.s   .034exit_and_eval
0402'                                   149+.034morework
0402'      4A47                         149+                tst.w   d7
0404'      6B00  0014                   149+                bmi     .034maybedone
0408'      0C47  4900                   149+                cmp.w   #$4900,d7
040C'      67E6                         149+                beq     .034comeagain
040E'      0C47  0900                   149+                cmp.w   #$900,d7
0412'      6FE0                         149+                ble     .034comeagain
0414'      6100  FBEA                   149+                bsr     exception
0418'      60D4                         149+                bra     .034restart
041A'                                   149+.034maybedone
041A'      0C47  8900                   149+                cmp.w   #$8900,d7
041E'      67D4                         149+                beq.s   .034comeagain
0420'      0C47  C900                   149+                cmp.w   #$C900,d7
0424'      67CE                         149+                beq.s   .034comeagain
0426'                                   149+.034exit_and_eval:
0426'      2280                         150         move.l  d0,(a1)
0428'      2281                         151         move.l  d1,(a1)
                                        152         NULREL
042A'      4A50                         152+.035nr  tst.w   (a0)
042C'      6BFC                         152+        bmi     .035nr
                                        153         NULCA1  #fmvfrcr+fpcr
042E'      317C  B000  000A             153+.036restart     move.w  #fmvfrcr+fpcr,command(a0)
0434'      3E10                         153+.036comeagain   move.w  (a0),d7
0436'      0807  000C                   153+                btst    #12,d7
043A'      6706                         153+                beq.s   .036morework
                                        153+;               bit 12=1
043C'      0807  000B                   153+                btst    #11,d7
0440'      6724                         153+                beq.s   .036exit_and_eval
0442'                                   153+.036morework
0442'      4A47                         153+                tst.w   d7
0444'      6B00  0014                   153+                bmi     .036maybedone
0448'      0C47  4900                   153+                cmp.w   #$4900,d7
044C'      67E6                         153+                beq     .036comeagain
044E'      0C47  0900                   153+                cmp.w   #$900,d7
0452'      6FE0                         153+                ble     .036comeagain
0454'      6100  FBAA                   153+                bsr     exception
0458'      60D4                         153+                bra     .036restart
045A'                                   153+.036maybedone
045A'      0C47  8900                   153+                cmp.w   #$8900,d7
045E'      67D4                         153+                beq.s   .036comeagain
0460'      0C47  C900                   153+                cmp.w   #$C900,d7
MC68000 ASSEMBLER VERSION 11.183                                                                                                   

   LOC              OBJECT             STMT            SOURCE STATEMENT


0464'      67CE                         153+                beq.s   .036comeagain
0466'                                   153+.036exit_and_eval:
0466'      2F11                         154         move.l  (a1),-(sp)              ; save current rounding mode
                                        155         NULREL
0468'      4A50                         155+.037nr  tst.w   (a0)
046A'      6BFC                         155+        bmi     .037nr
                                        156         NULCA1  #fmvtocr+fpcr
046C'      317C  9000  000A             156+.038restart     move.w  #fmvtocr+fpcr,command(a0)
0472'      3E10                         156+.038comeagain   move.w  (a0),d7
0474'      0807  000C                   156+                btst    #12,d7
0478'      6706                         156+                beq.s   .038morework
                                        156+;               bit 12=1
047A'      0807  000B                   156+                btst    #11,d7
047E'      6724                         156+                beq.s   .038exit_and_eval
0480'                                   156+.038morework
0480'      4A47                         156+                tst.w   d7
0482'      6B00  0014                   156+                bmi     .038maybedone
0486'      0C47  4900                   156+                cmp.w   #$4900,d7
048A'      67E6                         156+                beq     .038comeagain
048C'      0C47  0900                   156+                cmp.w   #$900,d7
0490'      6FE0                         156+                ble     .038comeagain
0492'      6100  FB6C                   156+                bsr     exception
0496'      60D4                         156+                bra     .038restart
0498'                                   156+.038maybedone
0498'      0C47  8900                   156+                cmp.w   #$8900,d7
049C'      67D4                         156+                beq.s   .038comeagain
049E'      0C47  C900                   156+                cmp.w   #$C900,d7
04A2'      67CE                         156+                beq.s   .038comeagain
04A4'                                   156+.038exit_and_eval:
04A4'      22BC  0000  00A0             157         move.l  #$000000a0,(a1)         ; round to -infinity
                                        158         NULREL
04AA'      4A50                         158+.039nr  tst.w   (a0)
04AC'      6BFC                         158+        bmi     .039nr
04AE'      317C  0001  000A             159         move.w  #fint+fp0,command(a0)
                                        160         NULREL
04B4'      4A50                         160+.040nr  tst.w   (a0)
04B6'      6BFC                         160+        bmi     .040nr
                                        161         NULCA1  #fmvfrfp+fp0
04B8'      317C  7400  000A             161+.041restart     move.w  #fmvfrfp+fp0,command(a0)
04BE'      3E10                         161+.041comeagain   move.w  (a0),d7
04C0'      0807  000C                   161+                btst    #12,d7
04C4'      6706                         161+                beq.s   .041morework
                                        161+;               bit 12=1
04C6'      0807  000B                   161+                btst    #11,d7
04CA'      6724                         161+                beq.s   .041exit_and_eval
04CC'                                   161+.041morework
04CC'      4A47                         161+                tst.w   d7
04CE'      6B00  0014                   161+                bmi     .041maybedone
04D2'      0C47  4900                   161+                cmp.w   #$4900,d7
04D6'      67E6                         161+                beq     .041comeagain
04D8'      0C47  0900                   161+                cmp.w   #$900,d7
04DC'      6FE0                         161+                ble     .041comeagain
04DE'      6100  FB20                   161+                bsr     exception
04E2'      60D4                         161+                bra     .041restart
04E4'                                   161+.041maybedone
MC68000 ASSEMBLER VERSION 11.183                                                                                                   

   LOC              OBJECT             STMT            SOURCE STATEMENT


04E4'      0C47  8900                   161+                cmp.w   #$8900,d7
04E8'      67D4                         161+                beq.s   .041comeagain
04EA'      0C47  C900                   161+                cmp.w   #$C900,d7
04EE'      67CE                         161+                beq.s   .041comeagain
04F0'                                   161+.041exit_and_eval:
04F0'      2011                         162         move.l  (a1),d0
04F2'      2211                         163         move.l  (a1),d1
                                        164         NULREL
04F4'      4A50                         164+.042nr  tst.w   (a0)
04F6'      6BFC                         164+        bmi     .042nr
                                        165         NULCA1  #fmvtocr+fpcr
04F8'      317C  9000  000A             165+.043restart     move.w  #fmvtocr+fpcr,command(a0)
04FE'      3E10                         165+.043comeagain   move.w  (a0),d7
0500'      0807  000C                   165+                btst    #12,d7
0504'      6706                         165+                beq.s   .043morework
                                        165+;               bit 12=1
0506'      0807  000B                   165+                btst    #11,d7
050A'      6724                         165+                beq.s   .043exit_and_eval
050C'                                   165+.043morework
050C'      4A47                         165+                tst.w   d7
050E'      6B00  0014                   165+                bmi     .043maybedone
0512'      0C47  4900                   165+                cmp.w   #$4900,d7
0516'      67E6                         165+                beq     .043comeagain
0518'      0C47  0900                   165+                cmp.w   #$900,d7
051C'      6FE0                         165+                ble     .043comeagain
051E'      6100  FAE0                   165+                bsr     exception
0522'      60D4                         165+                bra     .043restart
0524'                                   165+.043maybedone
0524'      0C47  8900                   165+                cmp.w   #$8900,d7
0528'      67D4                         165+                beq.s   .043comeagain
052A'      0C47  C900                   165+                cmp.w   #$C900,d7
052E'      67CE                         165+                beq.s   .043comeagain
0530'                                   165+.043exit_and_eval:
0530'      229F                         166         move.l  (sp)+,(a1)
                                        167         NULREL
0532'      4A50                         167+.044nr  tst.w   (a0)
0534'      6BFC                         167+        bmi     .044nr
                                        168         SHUTDOWN
0536'      2E1F                         168+        move.l  (sp)+,d7
0538'      4E75                         168+        rts
                                        169         xdef    init_io68881
053A'                                   170 init_io68881:
                                        171         SETUP
053A'      2F07                         171+        move.l  d7,-(sp)                ; used for exception processing
053C'      206E  0024                   171+        move.l  MathIEEEBase_68881(a6),a0       ; points to base of 68881 regs
0540'      43E8  0010                   171+        lea     operand(a0),a1          ; preload a1
0544'      7000                         172         moveq   #0,d0
0546'      3140  0006                   173         move.w  d0,restore(a0)  ; abort current instruction
                                        174                                 ; and begin reset of 881 state
054A'      3028  0006                   175         move.w  restore(a0),d0  ; get verifification
054E'      0240  FF00                   176         and.w   #$FF00,d0
                                        177 *>      if <>                   ; we expect to '0' return
0552'      6702                         178         beq.s _if00002
0554'      4E75                         179                 rts             ; return with error
                                        180 *>      endif
MC68000 ASSEMBLER VERSION 11.183                                                                                                   

   LOC              OBJECT             STMT            SOURCE STATEMENT


0556'                                   181 _if00002:
                                        182         NULREL
0556'      4A50                         182+.045nr  tst.w   (a0)
0558'      6BFC                         182+        bmi     .045nr
                                        183         NULCA1  #fmvtocr+fpcr
055A'      317C  9000  000A             183+.046restart     move.w  #fmvtocr+fpcr,command(a0)
0560'      3E10                         183+.046comeagain   move.w  (a0),d7
0562'      0807  000C                   183+                btst    #12,d7
0566'      6706                         183+                beq.s   .046morework
                                        183+;               bit 12=1
0568'      0807  000B                   183+                btst    #11,d7
056C'      6724                         183+                beq.s   .046exit_and_eval
056E'                                   183+.046morework
056E'      4A47                         183+                tst.w   d7
0570'      6B00  0014                   183+                bmi     .046maybedone
0574'      0C47  4900                   183+                cmp.w   #$4900,d7
0578'      67E6                         183+                beq     .046comeagain
057A'      0C47  0900                   183+                cmp.w   #$900,d7
057E'      6FE0                         183+                ble     .046comeagain
0580'      6100  FA7E                   183+                bsr     exception
0584'      60D4                         183+                bra     .046restart
0586'                                   183+.046maybedone
0586'      0C47  8900                   183+                cmp.w   #$8900,d7
058A'      67D4                         183+                beq.s   .046comeagain
058C'      0C47  C900                   183+                cmp.w   #$C900,d7
0590'      67CE                         183+                beq.s   .046comeagain
0592'                                   183+.046exit_and_eval:
           False                        184         ifd     ALLOW_TRAPS
0592'                                   185         move.l  #$00001490,(a1)         ; round to 0, chop mode
                                        186                                         ; trigger exception on div0,ovfl
                                        187         endc
           True                         188         ifnd    ALLOW_TRAPS
0592'      22BC  0000  0090             189         move.l  #$00000090,(a1)         ; round to 0, chop mode
                                        190         endc
                                        191         NULREL
0598'      4A50                         191+.047nr  tst.w   (a0)
059A'      6BFC                         191+        bmi     .047nr
059C'      4280                         192         clr.l   d0
                                        193         SHUTDOWN
059E'      2E1F                         193+        move.l  (sp)+,d7
05A0'      4E75                         193+        rts
05A2'                                   194 EndCode:
                                        195         END



No errors found in this Assembly
